{
    "sourceFile": "src/components/admin/manageadmin.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1710309721560,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1710309859837,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -427,9 +427,9 @@\n             </div>\n           </div>\n         </div>\n         <SAlert\n-className=\"text-capitalize\"\n+  style={{ textTransform: 'capitalize' }}\n           show={deleteAlert}\n           title={deleteName}\n           text=\"Are you Sure you want to delete !\"\n           onConfirm={() => deleteAdmin(deleteId)}\n"
                },
                {
                    "date": 1710310148831,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -427,9 +427,8 @@\n             </div>\n           </div>\n         </div>\n         <SAlert\n-  style={{ textTransform: 'capitalize' }}\n           show={deleteAlert}\n           title={deleteName}\n           text=\"Are you Sure you want to delete !\"\n           onConfirm={() => deleteAdmin(deleteId)}\n"
                }
            ],
            "date": 1710309721560,
            "name": "Commit-0",
            "content": "import React, { useState, useEffect } from \"react\";\nimport AdminHeader from \"./header\";\nimport AdminSidebar from \"./sidebar\";\nimport CustomButton from \"../common/button\";\nimport Addadmin from \"../forms/admin/addadmin\";\nimport { getallAdminData, DeleteAdmin, GetManagerTeam } from \"../../api/api\";\nimport { ToastContainer, toast } from \"react-toastify\";\nimport SAlert from \"../common/sweetAlert\";\nimport FilterJson from \"../json/filterjson\";\nimport Loader from \"../common/loader\";\nimport ExecutiveBox from \"../common/executiveBox\";\nimport AdminTable from \"../common/adminTable\";\nimport Executivelist from \"../common/executivelist\";\nimport { BsEnvelope } from \"react-icons/bs\";\nimport { BiPhoneCall } from \"react-icons/bi\";\nimport { Link } from \"react-router-dom\";\nfunction ManageAdmin() {\n  /*data and id state */\n  let [apiCall, setApiCall] = useState(false);\n  let [executiveapiCall, setExecutiveApiCall] = useState(false);\n  let [showAminDetails /*, setShowAminDetails*/] = useState(false);\n  let [showAddAdminModal, setShowAdminModal] = useState(false);\n  let [adminData, setAdminData] = useState([]);\n  let [executiveData, setexecutiveData] = useState([]);\n  let [managerData, setManagerData] = useState({});\n  let [managerExecutive, setManagerExecutive] = useState([]);\n  let [adminId, setAdminID] = useState();\n  let [showManagerDetailBox, setShowManagerDetailBox] = useState(false);\n  let [isLoading, setIsLoading] = useState(true);\n  let [addTeamListShow, setAddTeamListShow] = useState(false);\n  /*delete state */\n  const [deleteAlert, setDeleteAlert] = useState(false);\n  const [deleteId, setDeleteID] = useState();\n  const [deleteName, setDeleteName] = useState(\"\");\n  /*Filter and search state */\n  const [typeFilterValue, setTypeFilterValue] = useState(\"\");\n  const [search, setSearch] = useState(\"\");\n  const [searcherror, setSearchError] = useState(\"\");\n  /*Pagination states */\n  const [totalData, setTotalData] = useState(\"\");\n  const [currentPage, setCurrentPage] = useState(1);\n  const [recordsPerPage] = useState(10);\n  /*Shorting states */\n  const [columnName, setcolumnName] = useState(\"admin_id\");\n  const [sortOrder, setSortOrder] = useState(\"DESC\");\n\n  /* Function to get the Amin data*/\n  const AdminData = async () => {\n    setIsLoading(true);\n    try {\n      const userData = await getallAdminData(\n        typeFilterValue,\n        search,\n        currentPage,\n        recordsPerPage,\n        columnName,\n        sortOrder\n      );\n      if (userData.data.length === 0) {\n        setAdminData([]);\n        setIsLoading(false);\n      } else {\n        setAdminData(userData.data);\n        setTotalData(userData.total_rows);\n\n        //  Condition to get manager and its executive\n        if (\n          userData.data.filter((item) => item.admin_type === \"manager\")\n            .length !== 0\n        ) {\n          OnManagerDetailClick(\n            userData.data.filter((item) => item.admin_type === \"manager\")[0]\n          );\n        }\n        if (apiCall === true) {\n          let Admin_name = userData.data.filter(\n            (data) => data.admin_id === localStorage.getItem(\"admin_id\")\n          );\n          if (Admin_name[0].admin_id === localStorage.getItem(\"admin_id\")) {\n            localStorage.setItem(\"admin\", Admin_name[0].name);\n          }\n        }\n        setIsLoading(false);\n      }\n    } catch (err) {\n      console.log(err);\n      setIsLoading(false);\n    }\n  };\n\n  /*Render function to get the Admin*/\n  useEffect(() => {\n    AdminData();\n    if (apiCall === true) {\n      setApiCall(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    typeFilterValue,\n    search,\n    currentPage,\n    recordsPerPage,\n    columnName,\n    sortOrder,\n    apiCall,\n  ]);\n\n  /* Function to show the single data to update Admin*/\n  const editAdmin = (e) => {\n    // e.preventDefault();\n    setShowAdminModal(true);\n    setAdminID(e);\n  };\n  /*To Show the delete alert box */\n  const ShowDeleteAlert = (e) => {\n    setDeleteID(e.admin_id);\n    setDeleteName(e.name);\n    setDeleteAlert(true);\n  };\n  /*To cancel the delete alert box */\n  const CancelDelete = () => {\n    setDeleteAlert(false);\n  };\n  /*To call Api to delete category */\n  async function deleteAdmin(e) {\n    try {\n      const responseData = await DeleteAdmin(e);\n      if (responseData.message === \"admin has been deleted\") {\n        toast.error(\"Admin deleted Successfully\", {\n          position: toast.POSITION.TOP_RIGHT,\n          autoClose: 1000,\n        });\n        setApiCall(true);\n        setDeleteAlert(false);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  }\n  /*Search Onchange function to filter the data */\n  const onSearch = (e) => {\n    const inputValue = e.target.value;\n    setSearch(inputValue);\n    setCurrentPage(1);\n    if (inputValue.length > 0) {\n      if (/[-]?\\d+(\\.\\d+)?/.test(inputValue.charAt(0))) {\n        setSearchError(\"Admin Name cannot start with a number.\");\n      } else if (!/^[A-Za-z0-9 ]*$/.test(inputValue)) {\n        setSearchError(\"Cannot use special characters.\");\n      } else {\n        setSearchError(\"\");\n      }\n    } else {\n      setSearchError(\"\");\n    }\n  };\n  /*Pagination Calculation */\n  const nPages = Math.ceil(totalData / recordsPerPage);\n\n  /*Sorting Function */\n  const handleSort = (columnName) => {\n    setSortOrder(sortOrder === \"DESC\" ? \"ASC\" : \"DESC\");\n    setcolumnName(columnName);\n    setCurrentPage(1);\n  };\n\n  /*Function to open manager detail page */\n  const OnManagerDetailClick = async (data) => {\n    try {\n      let Response = await GetManagerTeam(data.admin_id);\n      if (Response.message === \"Successfully\") {\n        setManagerData(data);\n        setexecutiveData(Response.data.data);\n        setManagerExecutive(\n          Response.data.data.filter((item) => item.parent_id !== \"0\")\n        );\n        setShowManagerDetailBox(true);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n  useEffect(() => {\n    if (executiveapiCall === true) {\n      OnManagerDetailClick(managerData);\n      setExecutiveApiCall(false);\n    }\n  }, [executiveapiCall, apiCall]);\n  /*Function o add task to the executive */\n  // const AddTask = async () => {\n  //   setAddTeamListShow(false);\n  // };\n\n  return (\n    <>\n      <div className=\"site-wrapper overflow-hidden bg-default-2\">\n        {/* <!-- Header Area --> */}\n        <AdminHeader heading={\"Manage Admin\"} />\n        {/* <!-- navbar- --> */}\n        <AdminSidebar heading={\"Manage Admin\"} />\n        <ToastContainer />\n        {showAddAdminModal ? (\n          <Addadmin\n            show={showAddAdminModal}\n            adminId={adminId}\n            apiCall={apiCall}\n            setApiCall={setApiCall}\n            close={() => setShowAdminModal(false)}\n          />\n        ) : null}\n        <div\n          className={\n            showAminDetails === false\n              ? \"dashboard-main-container mt-16\"\n              : \"d-none\"\n          }\n          id=\"dashboard-body\"\n        >\n          <div className=\"container-fluid\">\n            <div className=\"row\">\n              <div className=\"col-6 mb-18\">\n                <div className=\"mb-4 align-items-center\">\n                  <div className=\"page___heading\">\n                    <h3 className=\"font-size-6 mb-0\">Admin</h3>\n                  </div>\n                  <div className=\"row m-0 align-items-center\">\n                    <div className=\"col p-1 form_group mb-3\">\n                      <p className=\"input_label\">Search:</p>\n                      <input\n                        required\n                        maxLength={30}\n                        type=\"text\"\n                        className=\"form-control \"\n                        placeholder={\"Admin Name\"}\n                        value={search}\n                        name={\"Admin_name\"}\n                        onChange={(e) => {\n                          onSearch(e);\n                        }}\n                      />\n                    </div>\n                    <div className=\"col p-1 form_group mb-3\">\n                      <p className=\"input_label\">Filter by Admin:</p>\n                      <div className=\"select_div\">\n                        <select\n                          name=\"type\"\n                          value={typeFilterValue}\n                          id=\"type\"\n                          onChange={(e) => {\n                            setTypeFilterValue(e.target.value);\n                            setCurrentPage(1);\n                          }}\n                          className=\"text-capitalize form-control\"\n                        >\n                          <option value=\"\">Admin type</option>\n                          {(FilterJson.admintype || []).map((type, i) => (\n                            <option value={type} key={i}>\n                              {type}\n                            </option>\n                          ))}\n                        </select>\n                      </div>\n                    </div>\n                    <div className=\"col px-1 form_group mt-4 text-right\">\n                      <CustomButton\n                        className=\"font-size-3 rounded-3 btn btn-primary border-0\"\n                        onClick={() => editAdmin(\"0\")}\n                        title=\"Add Admin\"\n                      >\n                        Add Admin\n                      </CustomButton>\n                    </div>\n                  </div>\n                  <small className=\"text-danger\">{searcherror}</small>\n                </div>\n                {\n                  <AdminTable\n                    data={adminData}\n                    isLoading={isLoading}\n                    handleSort={handleSort}\n                    editAdmin={editAdmin}\n                    ShowDeleteAlert={ShowDeleteAlert}\n                    nPages={nPages}\n                    currentPage={currentPage}\n                    setCurrentPage={setCurrentPage}\n                    totalData={totalData}\n                    page={\"admin page\"}\n                    OnManagerDetailClick={OnManagerDetailClick}\n                    setAddTeamListShow={setAddTeamListShow}\n                    setExecutiveApiCall={setExecutiveApiCall}\n                  />\n                }\n              </div>\n              {showManagerDetailBox && (\n                <div className=\"card p-3 mt-2 col-6 mb-18\">\n                  <div className=\"mb-4 align-items-center\">\n                    <div className=\"page___heading\">\n                      <h3 className=\"font-size-6 mb-0\">Admin</h3>\n                    </div>\n                    <div className=\"row m-0 align-items-center\">\n                      <div className=\"col p-1 form_group mb-3 \">\n                        <div className=\"d-flex executive_box gx-2\">\n                          <div className=\"media  align-items-center\">\n                            <div className=\"circle-40 mx-auto overflow-hidden\">\n                              {managerData.profile_image === null ? (\n                                <img\n                                  src=\"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460__340.png\"\n                                  alt=\"\"\n                                  className=\"w-100\"\n                                />\n                              ) : (\n                                <img\n                                  src={managerData.profile_image}\n                                  alt=\"\"\n                                  className=\"w-100\"\n                                />\n                              )}\n                            </div>\n                          </div>\n\n                          <div className=\" mb-0\">\n                            {managerData.name === null ||\n                            managerData.name === undefined ||\n                            managerData.name === \"undefined\" ||\n                            managerData.name === \"\" ? (\n                              <p className=\"font-size-3  mb-0\">N/A</p>\n                            ) : (\n                              <h5 className=\"m-0 text-black-3 font-weight-bold text-capitalize\">\n                                {managerData.name}\n                                <small className=\"text-gray font-size-3 m-0 \">\n                                  ({managerData.admin_type})\n                                </small>\n                              </h5>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"col p-1 mb-3 d-flex mx-2\">\n                        {!managerData.email ? null : (\n                          <div>\n                            <Link\n                              className=\"mx-2 font-size-3 text-break btn btn-outline-secondary btn-rounded \"\n                              to={`mailto:${managerData.email}`}\n                            >\n                              <BsEnvelope className=\"font-size-3 mr-4\" />\n                              {managerData.email}\n                            </Link>\n                          </div>\n                        )}\n                        {!managerData.contact_no ? null : (\n                          <div>\n                            <Link\n                              className=\"mx-2 font-size-3 text-break btn btn-outline-secondary btn-rounded \"\n                              to={`tel:${managerData.contact_no}`}\n                            >\n                              <BiPhoneCall className=\"font-size-3 mr-4\" />\n                              {managerData.contact_no}\n                            </Link>\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"bg-white shadow-8 datatable_div  pt-7 rounded pb-9 px-5\">\n                    <div className=\"\">\n                      {isLoading ? (\n                        <Loader />\n                      ) : addTeamListShow === true ? (\n                        <div className=\"card-text\">\n                          <h5>Executive's List</h5>\n                          <Executivelist\n                            manager_id={managerData.admin_id}\n                            executiveData={executiveData}\n                            selected={managerExecutive}\n                            setExecutiveApiCall={setExecutiveApiCall}\n                          />\n                        </div>\n                      ) : (\n                        <div\n                          className=\"accordion accordion-flush\"\n                          id=\"accordionFlushExample\"\n                        >\n                          {managerExecutive.length === 0 ? (\n                            <div className=\"text-center\">\n                              <h5>No Executive found</h5>\n                            </div>\n                          ) : (\n                            (managerExecutive || []).map((item, index) => (\n                              <ExecutiveBox\n                                data={item}\n                                index={index}\n                                key={index}\n                                manager_id={managerData.admin_id}\n                                selected={managerExecutive}\n                                setExecutiveApiCall={setExecutiveApiCall}\n                              />\n                            ))\n                          )}\n                        </div>\n                      )}\n                      <div className=\"col px-1 form_group mt-4 text-center\">\n                        <CustomButton\n                          className={\n                            addTeamListShow === true\n                              ? \"font-size-3 rounded-3 btn btn-light border-0\"\n                              : \"font-size-3 rounded-3 btn btn-primary border-0\"\n                          }\n                          onClick={\n                            addTeamListShow === true\n                              ? () => {\n                                  setAddTeamListShow(false);\n                                  setExecutiveApiCall(true);\n                                }\n                              : () => setAddTeamListShow(true)\n                          }\n                          title={\n                            addTeamListShow === true ? \"Cancel\" : \"Add Team\"\n                          }\n                        >\n                          {addTeamListShow === true ? \"Cancel\" : \"Add Team\"}\n                        </CustomButton>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n        <SAlert\nclassName=\"text-capitalize\"\n          show={deleteAlert}\n          title={deleteName}\n          text=\"Are you Sure you want to delete !\"\n          onConfirm={() => deleteAdmin(deleteId)}\n          showCancelButton={true}\n          onCancel={CancelDelete}\n        />\n      </div>\n    </>\n  );\n}\n\nexport default ManageAdmin;\n"
        }
    ]
}