{
    "sourceFile": "src/components/admin/generateToken.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1693486956906,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1693487246578,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,9 +59,12 @@\n       const responseData = await GetAdminToken(AdminId);\n       if (responseData.message === \"successful\") {\n         localStorage.setItem(\"view_as_token_admin_type\", AdminType);\n         localStorage.setItem(\"view_as_token\", responseData.token);\n-        toast.success(\"Token Generated successfully\", \n+        toast.success(\"Token Generated successfully\", {\n+          position: toast.POSITION.TOP_RIGHT,\n+          autoClose: 1000,\n+        });\n         close();\n         window.location.reload();\n       }\n       if (responseData.message === \"Unauthorized admin\") {\n"
                }
            ],
            "date": 1693486956906,
            "name": "Commit-0",
            "content": "import React, { useState, useEffect } from \"react\";\nimport { getallAdminData, GetAdminToken } from \"../../api/api\";\nimport Select from \"react-select\";\nimport { Modal } from \"react-bootstrap\";\nimport { toast } from \"react-toastify\";\nexport default function GenerateToken(props) {\n  /*States */\n  let [allAdmin, setAllAdmin] = useState([]);\n  let [AdminId, setAdminId] = useState(\"\");\n  let [AdminType, setAdminType] = useState(\"\");\n  const [state, setState] = useState([]);\n  let [Unauthorized, setUnauthorized] = useState(\"\")\n\n  /*Function to get admin list */\n  const AdminData = async () => {\n    try {\n      const userData = await getallAdminData();\n      if (userData.data.length === 0) {\n        setAllAdmin([]);\n      } else {\n        const filteredData = userData.data.filter(item => item.admin_type === \"manager\");\n        setAllAdmin(filteredData);\n      }\n    } catch (err) {\n      console.log(err)\n    }\n  };\n\n  /* Functionality to close the modal */\n  const close = () => {\n    setState([]);\n    setAdminId(\"\");\n    setUnauthorized(\"\")\n    props.close();\n  };\n  /*Render function to get admin list */\n  useEffect(() => {\n    AdminData();\n  }, [props]);\n\n  // GENERATE ADMIN TOKEN UPDATE SUBMIT BUTTON\n  const onSelectChange = (option) => {\n    setAdminId(option.value.admin_id);\n    setAdminType(option.value.admin_type)\n  };\n  /*Render function to set data in search select box */\n  useEffect(() => {\n    const options = allAdmin.map((option) => ({\n      value: option,\n      label: option.name + \" - \" + option.admin_type,\n    }));\n    setState(options);\n  }, [allAdmin]);\n\n  /*Function to generate Token of other admin to view as him */\n  const onTokenGenerateClick = async (event) => {\n    event.preventDefault();\n    try {\n      const responseData = await GetAdminToken(AdminId);\n      if (responseData.message === \"successful\") {\n        localStorage.setItem(\"view_as_token_admin_type\", AdminType);\n        localStorage.setItem(\"view_as_token\", responseData.token);\n        toast.success(\"Token Generated successfully\", \n        close();\n        window.location.reload();\n      }\n      if (responseData.message === \"Unauthorized admin\") {\n        setUnauthorized(\"Unauthorized admin\")\n      }\n    } catch (err) {\n      console.log(err)\n    }\n  };\n  /*Function to reset the token */\n  const onRest = () => {\n    localStorage.setItem(\"view_as_token\", \"\");\n    localStorage.setItem(\"view_as_token_admin_type\", \"\");\n    toast.success(\"Token Reset successfully\", {\n      position: toast.POSITION.TOP_RIGHT,\n      autoClose: 1000,\n    });\n    close();\n    window.location.reload();\n  };\n  return (\n    <>\n      <Modal\n        show={props.show}\n        size=\"md\"\n        aria-labelledby=\"contained-modal-title-vcenter\"\n        centered\n      >\n        <button\n          type=\"button\"\n          className=\"circle-32 btn-reset bg-white pos-abs-tr mt-md-n6 mr-lg-n6 focus-reset z-index-supper\"\n          data-dismiss=\"modal\"\n          onClick={props.close}\n        >\n          <i className=\"fas fa-times\"></i>\n        </button>\n        <div className=\"bg-white rounded h-100 px-11 pt-15\">\n          {/* CHANGE PASSWORD FORM */}\n          <form onSubmit={onTokenGenerateClick}>\n            {/* FORM FIELDS */}\n            <div className=\"form-group w-100 \">\n              <label\n                htmlFor=\"view_layout\"\n                className=\"font-size-4 text-black-2  line-height-reset\"\n              >\n                View as Layout :\n              </label>\n              <Select\n                options={state}\n                onChange={onSelectChange}\n                id=\"view_layout\"\n                className=\"text-capitalize mx-1\"\n              />\n              <small className=\"text-danger\">{Unauthorized}</small>\n            </div>\n            {/* END FORM FIELDS  */}\n            <div className=\"form-group text-center\">\n              <button\n                className=\"btn  btn-secondary btn-small w-25 rounded-5 text-uppercase\"\n                type=\"submit\"\n              >\n                View as\n              </button>{\" \"}\n              <button\n                className=\"btn btn-primary rounded-5 text-uppercase mx-5\"\n                onClick={onRest}\n              >\n                Reset\n              </button>\n            </div>\n          </form>\n        </div>\n      </Modal>\n      {/* END CHANGE PASSWORD FORM */}\n    </>\n  );\n}\n"
        }
    ]
}