{
    "sourceFile": "src/components/forms/admin/addadmin.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1693486845044,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1693486958633,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -131,12 +131,9 @@\n           setAlready(\"Admin already exists\");\n           setLoading(false);\n         }\n       } catch (err) {\n-       console.log(err) {\n-          position: toast.POSITION.TOP_RIGHT,\n-          autoClose: 1000,\n-        });\n+       console.log(err) \n         setLoading(false);\n       }\n     } else {\n       setLoading(false);\n"
                }
            ],
            "date": 1693486845044,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\nimport { Modal } from \"react-bootstrap\";\nimport useValidation from \"../../common/useValidation\";\nimport { AdminDetails, AddAdmin } from \"../../../api//api\";\nimport { toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\n\nfunction Addadmin(props) {\n  let [already, setAlready] = useState(\"\");\n  let [loading, setLoading] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n\n  /*Function to show hide password */\n  const toggleShowPassword = () => setShowPassword((prev) => !prev);\n\n  const renderIcon = () => {\n    if (state.password.length > 0) {\n      return showPassword ? (\n        <i className=\"fa fa-eye-slash\"></i>\n      ) : (\n        <i className=\"fa fa-eye\"></i>\n      );\n    }\n    return null;\n  };\n\n  /* Functionality to close the modal */\n  const close = () => {\n    setState(initialFormState);\n    setErrors(\"\");\n    props.close();\n    setLoading(false);\n    setAlready(\"\");\n  };\n  // USER ADMIN PROFILE UPDATE VALIDATION\n\n  // INITIAL STATE ASSIGNMENT\n  const initialFormState = {\n    name: \"\",\n    email: \"\",\n    password: \"\",\n    admin_type: \"\",\n  };\n  // VALIDATION CONDITIONS\n  const validators = {\n    name: [\n      (value) =>\n        value === \"\" || value.trim() === \"\"\n          ? \"Admin name is required\"\n          : /[-]?\\d+(\\.\\d+)?/.test(value)\n            ? \"Admin name can not have a number.\"\n            : value.length < 2\n              ? \"Admin name should have 2 or more letters\"\n              : /[^A-Za-z 0-9]/g.test(value)\n                ? \"Cannot use special character \"\n                : \"\",\n    ],\n    email: [\n      (value) =>\n        value === \"\" || value.trim() === \"\"\n          ? \"Email is required\"\n          : /\\S+@\\S+\\.\\S+/.test(value)\n            ? null\n            : \"Email is invalid\",\n    ],\n    password: [\n      (value) =>\n        state.admin_id\n          ? value === \"\"\n          : value === \"\"\n            ? \"Password is required\"\n            : /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*\\W)(?!.* ).{8,16}$/.test(\n              value\n            )\n              ? null\n              : \"Password must contain digit, one uppercase letter, one special character, no space, and it must be 8-16 characters long\",\n    ],\n    admin_type: [\n      (value) =>\n        value === \"\" || value.trim() === \"\" ? \"Admin type is required\" : null,\n    ],\n  };\n  // CUSTOM VALIDATIONS IMPORT\n  const { state, setState, setErrors, onInputChange, errors, validate } =\n    useValidation(initialFormState, validators);\n  /*Function to get admin detail */\n  const AdminData = async () => {\n    try {\n      const userData = await AdminDetails(props.adminId);\n      if (userData === undefined || userData.data.length === 0) {\n        setState(initialFormState);\n      } else {\n        setState(userData.data[0]);\n      }\n    } catch (err) {\n      console.log(err)\n    }\n  };\n  useEffect(() => {\n    if (props.adminId === \"0\" || props.adminId === undefined) {\n      setState(initialFormState);\n    } else {\n      AdminData();\n    }\n  }, [props]);\n\n  // USER ADMIN PROFILE UPDATE SUBMIT BUTTON\n  const onAminProfileUpdateClick = async (event) => {\n    event.preventDefault();\n    if (validate()) {\n      setLoading(true);\n      try {\n        const responseData = await AddAdmin(state);\n        if (responseData.message === \"admin added successfully\") {\n          toast.success(\"Admin added successfully\", {\n            position: toast.POSITION.TOP_RIGHT,\n            autoClose: 1000,\n          });\n          props.setApiCall(true);\n          return close();\n        }\n        if (responseData.message === \"admin updated successfully\") {\n          toast.success(\"Admin Updated successfully\", {\n            position: toast.POSITION.TOP_RIGHT,\n            autoClose: 1000,\n          });\n          props.setApiCall(true);\n          return close();\n        }\n        if (responseData.message === \"Admin already exists\") {\n          setAlready(\"Admin already exists\");\n          setLoading(false);\n        }\n      } catch (err) {\n       console.log(err) {\n          position: toast.POSITION.TOP_RIGHT,\n          autoClose: 1000,\n        });\n        setLoading(false);\n      }\n    } else {\n      setLoading(false);\n    }\n  };\n  // END USER ADMIN PROFILE UPDATE VALIDATION\n  return (\n    <>\n      <Modal\n        show={props.show}\n        size=\"md\"\n        aria-labelledby=\"contained-modal-title-vcenter\"\n        centered\n      >\n        <button\n          type=\"button\"\n          className=\"circle-32 btn-reset bg-white pos-abs-tr mt-md-n6 mr-lg-n6 focus-reset z-index-supper \"\n          data-dismiss=\"modal\"\n          onClick={close}\n        >\n          <i className=\"fas fa-times\"></i>\n        </button>\n        <div className=\"bg-white rounded h-100 px-11 pt-7 overflow-y-hidden\">\n          {props.adminId === \"0\" ? (\n            <h5 className=\"text-center pt-2 mb-7\">Add Admin</h5>\n          ) : (\n            <h5 className=\"text-center pt-2 mb-7\">Update Admin</h5>\n          )}\n          <form onSubmit={onAminProfileUpdateClick}>\n            <div className=\"form-group\">\n              <label\n                htmlFor=\"name\"\n                className=\"font-size-4 text-black-2  line-height-reset\"\n              >\n                Admin Name <span className=\"text-danger\">*</span>\n              </label>\n              <input\n                type=\"text\"\n                className={\n                  errors.name\n                    ? \"form-control border border-danger\"\n                    : \"form-control\"\n                }\n                value={state.name}\n                onChange={onInputChange}\n                id=\"name\"\n                name=\"name\"\n                placeholder=\"eg. Apple\"\n              />\n              {/*----ERROR MESSAGE FOR Admin Name----*/}\n              {errors.name && (\n                <span key={errors.name} className=\"text-danger font-size-3\">\n                  {errors.name}\n                </span>\n              )}\n            </div>\n            <div className=\"form-group \">\n              <label\n                htmlFor=\"email\"\n                className=\"font-size-4 text-black-2  line-height-reset\"\n              >\n                E-mail <span className=\"text-danger\">*</span> :\n              </label>\n              <input\n                className={\n                  errors.email\n                    ? \"form-control border border-danger\"\n                    : \"form-control\"\n                }\n                value={state.email}\n                onChange={onInputChange}\n                id=\"email\"\n                name=\"email\"\n                type={\"email\"}\n                disabled={props.adminId === \"0\" ? false : true}\n              />\n              {/*----ERROR MESSAGE FOR EMAIL----*/}\n              {errors.email && (\n                <span key={errors.email} className=\"text-danger font-size-3\">\n                  {errors.email}\n                </span>\n              )}\n            </div>\n            {state.admin_id ? null : (\n              <div className=\"form-group \">\n                <label\n                  htmlFor=\"password\"\n                  className=\"font-size-4 text-black-2  line-height-reset\"\n                >\n                  Password <span className=\"text-danger\">*</span> :\n                </label>\n                <div className=\"position-relative\">\n                  <input\n                    type={showPassword ? \"text\" : \"password\"}\n                    className={\n                      errors.password\n                        ? \"form-control border border-danger\"\n                        : \"form-control\"\n                    }\n                    value={state.password}\n                    onChange={onInputChange}\n                    id=\"password\"\n                    name=\"password\"\n                  />\n                  <span className=\"password-icon\" onClick={toggleShowPassword}>\n                    {renderIcon()}\n                  </span>\n                </div>\n                {/*----ERROR MESSAGE FOR ADMIN PASSWORD----*/}\n                {errors.password && (\n                  <span\n                    key={errors.password}\n                    className=\"text-danger font-size-3\"\n                  >\n                    {errors.password}\n                  </span>\n                )}\n              </div>\n            )}\n            <div className=\"form-group \">\n              <label\n                htmlFor=\"admin_type\"\n                className=\"font-size-4 text-black-2  line-height-reset\"\n              >\n                Admin Type <span className=\"text-danger\">*</span> :\n              </label>\n              <select\n                type={\"text\"}\n                className={\n                  errors.admin_type\n                    ? \"form-control border border-danger\"\n                    : \"form-control\"\n                }\n                value={state.admin_type}\n                onChange={onInputChange}\n                id=\"admin_type\"\n                name=\"admin_type\"\n                multiple={false}\n              >\n                <option value={\"\"}>Select</option>\n                <option value={\"super-admin\"}>Superadmin</option>\n                <option value={\"admin\"}>Admin</option>\n                <option value={\"manager\"}>Manager</option>\n              </select>\n              {/*----ERROR MESSAGE FOR ADMIN TYPE----*/}\n              {errors.admin_type && (\n                <span\n                  key={errors.admin_type}\n                  className=\"text-danger font-size-3\"\n                >\n                  {errors.admin_type}\n                </span>\n              )}\n            </div>\n            <span className=\"text-danger font-size-3\">{already}</span>\n            <div className=\"form-group text-center\">\n              {loading === true ? (\n                <button\n                  className=\"btn btn-primary btn-small w-25 rounded-5 text-uppercase\"\n                  type=\"button\"\n                  disabled\n                >\n                  <span\n                    className=\"spinner-border spinner-border-sm \"\n                    role=\"status\"\n                    aria-hidden=\"true\"\n                  ></span>\n                  <span className=\"sr-only\">Loading...</span>\n                </button>\n              ) : (\n                <button\n                  className=\"btn btn-primary btn-small w-25 rounded-5 text-uppercase\"\n                  type=\"submit\"\n                >\n                  Submit\n                </button>\n              )}\n            </div>\n          </form>\n        </div>\n      </Modal>\n    </>\n  );\n}\n\nexport default Addadmin;\n"
        }
    ]
}