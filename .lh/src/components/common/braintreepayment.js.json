{
    "sourceFile": "src/components/common/braintreepayment.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1713877034635,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1713877034635,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\nimport dropin from \"braintree-web-drop-in\";\nimport { Button } from \"react-bootstrap\";\nimport { AddBrainTressPayment, AddPaymentToDataBase } from \"../../api/api\";\nimport { toast } from \"react-toastify\";\nfunction BraintreeDropIn(props) {\n  const { show, amount, setApicall, setState, state, setBraintreePayment } =\n    props;\n  let name = localStorage.getItem(\"name\");\n  const [braintreeInstance, setBraintreeInstance] = useState(undefined);\n  // authorization: \"sandbox_s9gd7m2p_vp62s592633kc5p5\", // insert your tokenization key or client token here\n  useEffect(() => {\n    if (show) {\n      const initializeBraintree = () =>\n        dropin.create(\n          {\n            authorization: \"sandbox_w3mdsskj_dk55fvq2pb2s746h\", // insert your tokenization key or client token here\n            container: \"#braintree-drop-in-div\",\n          },\n          function (error, instance) {\n            if (error) console.error(error);\n            else setBraintreeInstance(instance);\n          }\n        );\n\n      if (braintreeInstance) {\n        braintreeInstance.teardown().then(() => {\n          initializeBraintree();\n        });\n      } else {\n        initializeBraintree();\n      }\n    }\n    // eslint-disable-next-line\n  }, [show]);\n\n  return (\n    <div className=\"container braintree-container\">\n      <div style={{ display: `${show ? \"block\" : \"none\"}` }}>\n        <div id={\"braintree-drop-in-div\"} />\n\n        <Button\n          className={\"braintreePayButton btn btn-primary\"}\n          type=\"button\"\n          disabled={!braintreeInstance}\n          onClick={() => {\n            if (braintreeInstance) {\n              braintreeInstance.requestPaymentMethod(async (error, payload) => {\n                if (error) {\n                  console.error(error);\n                } else {\n                  const paymentMethodNonce = payload.nonce;\n                  try {\n                    let res = await AddBrainTressPayment(\n                      amount,\n                      paymentMethodNonce,\n                      name\n                    );\n                    if (res.data.success === true) {\n                      let data = {\n                        paymentID: res.data.paymentReceipt.id,\n                        orderID: res.data.paymentReceipt.globalId,\n                      };\n                      let response = await AddPaymentToDataBase(\n                        data,\n                        props.user_id,\n                        amount,\n                        \"Braintree\",\n                        props.user\n                      );\n                      if (response.status === 1 || \"1\") {\n                        toast.success(\"Payment Successful.\", {\n                          position: toast.POSITION.TOP_RIGHT,\n                          autoClose: 5000,\n                        });\n                        setApicall(true);\n                        setBraintreePayment(false);\n                        setState({ ...state, amount: \"\" });\n                      }\n                    }\n                  } catch (Err) {\n                    console.log(Err);\n                  }\n                }\n              });\n            }\n          }}\n        >\n          {\"Pay\"}\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nexport default BraintreeDropIn;\n"
        }
    ]
}