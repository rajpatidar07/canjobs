{
    "sourceFile": "src/components/common/payButton.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1710503309378,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1710504360086,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,109 @@\n+import React, { useEffect, useState } from \"react\";\n+import { Button } from \"react-bootstrap\";\n+import axios from \"axios\";\n+import { useNavigate } from \"react-router-dom\";\n+import { toast } from \"react-toastify\"; // You might need to import the appropriate toast library\n+\n+function RazorPay() {\n+  const navigate = useNavigate();\n+  const [loading, setLoading] = useState(false);\n+  // const [userData, setUserData*/] = useState({\n+  //   cart: [], // Initialize with your cart structure\n+  // });\n+\n+  useEffect(() => {\n+    // Fetch user data when the component mounts\n+    // Replace this with your actual fetchUserData function\n+    // fetchUserData()\n+    // .then((data) => {\n+    //   setUserData(data);\n+    // })\n+    // .catch((error) => {\n+    //   console.error(error.message);\n+    // });\n+  }, []);\n+\n+  // const fetchUserData = async () => {\n+  //   try {\n+  //     // Replace this with your actual API endpoint\n+  //     const response = await axios.get(\"http://localhost:8080/user/data\");\n+  //     return response.data; // Modify this based on your API response structure\n+  //   } catch (error) {\n+  //     throw new Error(error.message);\n+  //   }\n+  // };\n+\n+  const handlePay = async () => {\n+    const script = document.createElement(\"script\");\n+    script.src = \"https://checkout.razorpay.com/v1/checkout.js\";\n+    script.onerror = () => {\n+      alert(\"RazorPay SDK failed to load\");\n+    };\n+    script.onload = async () => {\n+      try {\n+        setLoading(true);\n+        // const total = userData.cart.reduce((a, b) => a + +b.price, 0).toFixed(0);\n+        const result = await axios.post(\n+          \"http://192.168.29.92/canjobs_razorpay/common/creatOrder\",\n+          {\n+            price: 90,\n+          }\n+        );\n+\n+        const { amount, id: orderId, currency } = result.data.data;\n+\n+        // const getkey = await axios.get(\"http://localhost:8080/payment/get-razorpay-key\");\n+        const key = \"rzp_test_m5J59Uvpq9YHDx\";\n+        const options = {\n+          key: key,\n+          amount: amount.toString(),\n+          currency: currency,\n+          name: \"We2code PVT LTD\",\n+          description: \"FIRST RAZOR PAY\",\n+          order_id: orderId,\n+          handler: async function (response) {\n+            await axios.put(\n+              \"http://192.168.29.92/canjobs_razorpay/common/addPaymentReceipt\",\n+              {\n+                amount: amount,\n+                razorpayPaymentId: response.razorpay_payment_id,\n+                razorpay0rderId: response.razorpay_order_id,\n+                razorpaysighature: response.razorpay_signature,\n+              }\n+            );\n+            // Perform any additional actions on successful payment here\n+            toast.success(\"Payment Successful.\", {\n+              position: toast.POSITION.TOP_RIGHT,\n+              autoClose: 5000,\n+            });\n+\n+            navigate(\"/\");\n+          },\n+          prefill: {\n+            name: \"We2code PVT LTD\",\n+            email: \"ashish.we2code@gmail.com\",\n+            contact: \"9754869920\",\n+          },\n+        };\n+        setLoading(false);\n+        const paymentObject = new window.Razorpay(options);\n+        paymentObject.open();\n+      } catch (error) {\n+        alert(error);\n+        setLoading(false);\n+      }\n+    };\n+    document.body.appendChild(script);\n+  };\n+\n+  return (\n+    <div>\n+      <Button className=\"btn btn-primary\" onClick={handlePay}>\n+        PAY\n+      </Button>{\" \"}\n+      {loading && <h3>...Loading please wait</h3>}\n+    </div>\n+  );\n+}\n+\n+export default RazorPay;\n"
                }
            ],
            "date": 1710503309378,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\nimport { Button } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { toast } from \"react-toastify\"; // You might need to import the appropriate toast library\n\nfunction RazorPay() {\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  // const [userData, setUserData*/] = useState({\n  //   cart: [], // Initialize with your cart structure\n  // });\n\n  useEffect(() => {\n    // Fetch user data when the component mounts\n    // Replace this with your actual fetchUserData function\n    // fetchUserData()\n    // .then((data) => {\n    //   setUserData(data);\n    // })\n    // .catch((error) => {\n    //   console.error(error.message);\n    // });\n  }, []);\n\n  // const fetchUserData = async () => {\n  //   try {\n  //     // Replace this with your actual API endpoint\n  //     const response = await axios.get(\"http://localhost:8080/user/data\");\n  //     return response.data; // Modify this based on your API response structure\n  //   } catch (error) {\n  //     throw new Error(error.message);\n  //   }\n  // };\n\n  const handlePay = async () => {\n    const script = document.createElement(\"script\");\n    script.src = \"https://checkout.razorpay.com/v1/checkout.js\";\n    script.onerror = () => {\n      alert(\"RazorPay SDK failed to load\");\n    };\n    script.onload = async () => {\n      try {\n        setLoading(true);\n        // const total = userData.cart.reduce((a, b) => a + +b.price, 0).toFixed(0);\n        const result = await axios.post(\n          \"http://192.168.29.92/canjobs_razorpay/common/creatOrder\",\n          {\n            price: 90,\n          }\n        );\n\n        const { amount, id: orderId, currency } = result.data.data;\n\n        // const getkey = await axios.get(\"http://localhost:8080/payment/get-razorpay-key\");\n        const key = \"rzp_test_m5J59Uvpq9YHDx\";\n        const options = {\n          key: key,\n          amount: amount.toString(),\n          currency: currency,\n          name: \"We2code PVT LTD\",\n          description: \"FIRST RAZOR PAY\",\n          order_id: orderId,\n          handler: async function (response) {\n            await axios.put(\n              \"http://192.168.29.92/canjobs_razorpay/common/addPaymentReceipt\",\n              {\n                amount: amount,\n                razorpayPaymentId: response.razorpay_payment_id,\n                razorpay0rderId: response.razorpay_order_id,\n                razorpaysighature: response.razorpay_signature,\n              }\n            );\n            // Perform any additional actions on successful payment here\n            toast.success(\"Payment Successful.\", {\n              position: toast.POSITION.TOP_RIGHT,\n              autoClose: 5000,\n            });\n\n            navigate(\"/\");\n          },\n          prefill: {\n            name: \"We2code PVT LTD\",\n            email: \"ashish.we2code@gmail.com\",\n            contact: \"9754869920\",\n          },\n        };\n        setLoading(false);\n        const paymentObject = new window.Razorpay(options);\n        paymentObject.open();\n      } catch (error) {\n        alert(error);\n        setLoading(false);\n      }\n    };\n    document.body.appendChild(script);\n  };\n\n  return (\n    <div>\n      <Button className=\"btn btn-primary\" onClick={handlePay}>\n        PAY\n      </Button>\n      {loading && <h3>...Loading please wait</h3>}\n    </div>\n  );\n}\n\nexport default RazorPay;\n"
        }
    ]
}