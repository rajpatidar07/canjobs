{
    "sourceFile": "src/components/common/changepassword.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1693486956902,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1693487288365,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -69,9 +69,9 @@\n           close()\n         }\n       }\n       catch(err){\n-        toast.success(\"Something went Wrong\", \n+        console.log(err) \n         setLoading(false);\n       }\n     }\n   };\n"
                }
            ],
            "date": 1693486956902,
            "name": "Commit-0",
            "content": "import React, { useState } from \"react\";\nimport useValidation from \"./useValidation\";\nimport { Modal } from \"react-bootstrap\";\nimport { ChangePasswordApi } from \"../../api/api\"\nimport { toast } from \"react-toastify\";\nconst ChangePassword = (props) => {\n  let [loading, setLoading] = useState(false)\n  // USER CHANGE PASSWORD VALIDATION\n\n  /* Functionality to close the modal */\n  const close = () => {\n    setState(initialFormState);\n    setErrors(\"\");\n    setLoading(false);\n    props.close();\n  };\n  // INITIAL STATE ASSIGNMENT\n  const initialFormState = {\n    password: \"\",\n    new_password: \"\",\n    conf_password: \"\",\n  };\n  // VALIDATION CONDITIONS\n  const validators = {\n    password: [\n      (value) =>\n        value === \"\" || value.trim() === \"\" ? \"Old password is required\" : null,\n    ],\n    new_password: [\n      (value) =>\n        value === \"\"\n          ? \"Password is required\"\n          : /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*\\W)(?!.* ).{8,16}$/.test(\n            value\n          )\n            ? null\n            : \"Password must contain digit, one uppercase letter, one special character, no space, and it must be 8-16 characters long\",\n    ],\n    conf_password: [\n      (value) => (value ? null : \"Confirm Password is required\"),\n      (value) =>\n        value === state.new_password\n          ? null\n          : \"Confirm Password must be Same as Password\",\n    ],\n  };\n  // CUSTOM VALIDATIONS IMPORT\n  const { state, onInputChange, setState, setErrors, errors, validate } = useValidation(\n    initialFormState,\n    validators\n  );\n\n  // USER CHANGE PASSWORD SUBMIT BUTTON\n  const onUserChangePassClick = async (event) => {\n    event.preventDefault();\n    if (validate()) {\n      setLoading(true)\n      try {\n        let Response = await ChangePasswordApi(state)\n        if (Response.message === \"Wrong password\") {\n          setErrors({ ...errors, password: \"Wrong current Password\" })\n          setLoading(false)\n        }\n        if (Response.message === \"Password updated successfully\") {\n          toast.success(\"Password updated successfully\", {\n            position: toast.POSITION.TOP_RIGHT,\n            autoClose: 1000,\n          });\n          close()\n        }\n      }\n      catch(err){\n        toast.success(\"Something went Wrong\", \n        setLoading(false);\n      }\n    }\n  };\n  // END USER CHANGE PASSWORD VALIDATION\n\n  return (\n    <>\n      <Modal\n        show={props.show}\n        size=\"md\"\n        aria-labelledby=\"contained-modal-title-vcenter\"\n        centered\n      >\n        <button\n          type=\"button\"\n          className=\"circle-32 btn-reset bg-white pos-abs-tr mt-md-n6 mr-lg-n6 focus-reset z-index-supper\"\n          data-dismiss=\"modal\"\n          onClick={close}\n        >\n          <i className=\"fas fa-times\"></i>\n        </button>\n        <div className=\"bg-white rounded h-100 px-11 pt-10\">\n          {/* CHANGE PASSWORD FORM */}\n          <form onSubmit={(e) => onUserChangePassClick(e)}>\n            <h5 className=\"text-center pb-8\"> Change Password</h5>\n            {/* FORM FIELDS */}\n            <div className=\"form-group\">\n              <label\n                htmlFor=\"password\"\n                className=\"font-size-4 text-black-2 font-weight-semibold line-height-reset\"\n              >\n                Old Password\n              </label>\n              <input\n                name=\"password\"\n                value={state.password}\n                onChange={onInputChange}\n                type=\"password\"\n                className={\n                  errors.password\n                    ? \"form-control border border-danger\"\n                    : \"form-control\"\n                }\n                id=\"password\"\n                placeholder=\"Enter old password\"\n              />\n              {/* ERROR MSG FOR OLD PASSWORD */}\n              {errors.password && (\n                <span\n                  key={errors.password}\n                  className=\"text-danger font-size-3\"\n                >\n                  {errors.password}\n                </span>\n              )}\n            </div>\n            <div className=\"form-group\">\n              <label\n                htmlFor=\"new_password\"\n                className=\"font-size-4 text-black-2 font-weight-semibold line-height-reset\"\n              >\n                Password\n              </label>\n              <div className=\"position-relative\">\n                <input\n                  name=\"new_password\"\n                  value={state.new_password}\n                  onChange={onInputChange}\n                  type=\"password\"\n                  className={\n                    errors.new_password\n                      ? \"form-control border border-danger\"\n                      : \"form-control\"\n                  }\n                  id=\"new_password\"\n                  placeholder=\"Enter password\"\n                />\n                {/* ERROR MSG FOR PASSWORD */}\n                {errors.new_password && (\n                  <span\n                    key={errors.new_password}\n                    className=\"text-danger font-size-3\"\n                  >\n                    {errors.new_password}\n                  </span>\n                )}\n              </div>\n            </div>\n            <div className=\"form-group\">\n              <label\n                htmlFor=\"conf_password\"\n                className=\"font-size-4 text-black-2 font-weight-semibold line-height-reset\"\n              >\n                Confirm Password\n              </label>\n              <div className=\"position-relative\">\n                <input\n                  name=\"conf_password\"\n                  value={state.conf_password}\n                  onChange={onInputChange}\n                  type=\"password\"\n                  className={\n                    errors.conf_password\n                      ? \"form-control border border-danger\"\n                      : \"form-control\"\n                  }\n                  id=\"conf_password\"\n                  placeholder=\"Enter new password\"\n                />\n                {errors.conf_password && (\n                  <span\n                    key={errors.conf_password}\n                    className=\"text-danger font-size-3\"\n                  >\n                    {errors.conf_password}\n                  </span>\n                )}\n              </div>\n            </div>\n            {/* END FORM FIELDS  */}\n            <div className=\"form-group text-center\">\n              {loading === true ? (\n                <button\n                  className=\"btn btn-primary btn-small w-25 rounded-5 text-uppercase\"\n                  type=\"button\"\n                  disabled\n                >\n                  <span\n                    className=\"spinner-border spinner-border-sm \"\n                    role=\"status\"\n                    aria-hidden=\"true\"\n                  ></span>\n                  <span className=\"sr-only\">Loading...</span>\n                </button>\n              ) : (\n                <button\n                  className=\"btn btn-primary btn-small w-25 rounded-5 text-uppercase\"\n                  type=\"submit\"\n                >\n                  Submit\n                </button>\n              )}\n\n            </div>\n          </form>\n        </div>\n      </Modal>\n      {/* END CHANGE PASSWORD FORM */}\n    </>\n  );\n};\n\nexport default ChangePassword;\n"
        }
    ]
}