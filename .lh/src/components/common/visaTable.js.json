{
    "sourceFile": "src/components/common/visaTable.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1693213004593,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1693213021322,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,9 +54,9 @@\n                 setIsLoading(false);\r\n             } else {\r\n                 setemployeeData(userData.data.data);\r\n                 setTotalData(userData.data.total_rows);\r\n-                if(res === \"user_profile\"){\r\n+                if(props.page === \"user_profile\"){\r\n                     props.setVisaStatus(userData.data.data)\r\n                 }\r\n                 setIsLoading(false);\r\n             }\r\n"
                },
                {
                    "date": 1693216866083,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -312,10 +312,10 @@\n                                             \"\"\r\n                                         )}\r\n                                     </tr>\r\n                                 ) : (\r\n-                                    (employeeData || []).map((empdata) => (\r\n-                                        <tr className=\"applicant_row\" key={empdata.employee_id}>\r\n+                                    (employeeData || []).map((empdata,i) => (\r\n+                                        <tr className=\"applicant_row\" key={i}>\r\n                                             <td className=\" py-5\">\r\n                                                 <p className=\"font-size-3 font-weight-normal text-black-2 mb-0\">\r\n                                                     <Link\r\n                                                         className=\"text-dark\" to={`/${empdata.employee_id}`}>\r\n"
                }
            ],
            "date": 1693213004593,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { GetEmployeeVisaList } from \"../../api/api\";\r\nimport moment from \"moment\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport Pagination from \"../common/pagination\";\r\nimport DocumentModal from \"../forms/admin/EmployeeDocumentModal\";\r\nimport Loader from \"../common/loader\";\r\nimport VisaStatus from \"../forms/user/visaStatus\";\r\nimport { toast } from \"react-toastify\";\r\nimport { LiaCcVisa } from \"react-icons/lia\"\r\nimport { GrDocumentUser } from \"react-icons/gr\"\r\nexport default function VisaTable(props) {\r\n    /*Show modal states */\r\n    let [apiCall, setApiCall] = useState(false);\r\n    let [isLoading, setIsLoading] = useState(true);\r\n    const [documentModal, setDocumentModal] = useState(false);\r\n    let [showVisaModal, setVisaModal] = useState(false);\r\n    /*data and id states */\r\n    const [employeeData, setemployeeData] = useState([]);\r\n    let [employeeId, setemployeeId] = useState();\r\n    // let [lmiaStatus, setLmiaStatus] = useState();\r\n    /*Pagination states */\r\n    const [totalData, setTotalData] = useState(\"\");\r\n    const [currentPage, setCurrentPage] = useState(1);\r\n    const [recordsPerPage] = useState(10);\r\n    /*Shorting states */\r\n    const [columnName, setcolumnName] = useState(\"employee_id\");\r\n    const [sortOrder, setSortOrder] = useState(\"DESC\");\r\n    /* Function to get Employee visa data*/\r\n    const EmpData = async () => {\r\n        setIsLoading(true);\r\n        try {\r\n            const userData = await GetEmployeeVisaList(\r\n                props.search,\r\n                props.VisStatusFilterValue,\r\n                props.VisaCountryFilterValue,\r\n                props.IntrestedFilterValue,\r\n                props.search ||\r\n                    props.VisStatusFilterValue ||\r\n                    props.VisaCountryFilterValue ||\r\n                    props.IntrestedFilterValue\r\n                    ? 1\r\n                    :\r\n                    currentPage,\r\n                recordsPerPage,\r\n                columnName,\r\n                sortOrder,\r\n                props.employee_id\r\n            );\r\n            // console.log(userData.data)\r\n            if (userData.data.data.length === 0) {\r\n                setemployeeData([]);\r\n                setIsLoading(false);\r\n            } else {\r\n                setemployeeData(userData.data.data);\r\n                setTotalData(userData.data.total_rows);\r\n                if(res === \"user_profile\"){\r\n                    props.setVisaStatus(userData.data.data)\r\n                }\r\n                setIsLoading(false);\r\n            }\r\n        } catch (err) {\r\n            toast.error(\"Something went wrong\", {\r\n                position: toast.POSITION.TOP_RIGHT,\r\n                autoClose: 1000,\r\n            });\r\n            setIsLoading(false)\r\n        }\r\n    };\r\n\r\n    /*Render function to get the employee data*/\r\n    useEffect(() => {\r\n        EmpData();\r\n        if (props.apiCall === true || apiCall === true) {\r\n            props.setApiCall(false);\r\n            setApiCall(false);\r\n        }\r\n    }, [\r\n        props.search,\r\n        props.VisStatusFilterValue,\r\n        props.VisaCountryFilterValue,\r\n        props.IntrestedFilterValue,\r\n        currentPage,\r\n        recordsPerPage,\r\n        columnName,\r\n        sortOrder,\r\n        props.apiCall,\r\n        apiCall,\r\n    ]);\r\n\r\n    /* Function to show the single data to update Employee*/\r\n    const editVisa = (e) => {\r\n        setVisaModal(true);\r\n        setemployeeId(e);\r\n    };\r\n\r\n    /*Function to open add Document up modal */\r\n    const AddDoucument = (e) => {\r\n        setDocumentModal(true);\r\n        setemployeeId(e.employee_id);\r\n        // setLmiaStatus(e.lmia_status)\r\n    };\r\n\r\n    /*Pagination Calculation */\r\n    const nPages = Math.ceil(totalData / recordsPerPage);\r\n\r\n    /*Sorting Function */\r\n    const handleSort = (columnName) => {\r\n        setSortOrder(sortOrder === \"DESC\" ? \"ASC\" : \"DESC\");\r\n        setcolumnName(columnName);\r\n        setCurrentPage(1)\r\n    };\r\n\r\n    return (\r\n        <>\r\n\r\n            {showVisaModal ? (\r\n                <VisaStatus\r\n                    show={showVisaModal}\r\n                    employeeData={employeeId}\r\n                    apiCall={apiCall}\r\n                    setApiCall={setApiCall}\r\n                    close={() => setVisaModal(false)}\r\n                />\r\n            ) : null}\r\n            {documentModal ? (\r\n                <DocumentModal\r\n                    show={documentModal}\r\n                    close={() => setDocumentModal(false)}\r\n                    employee_id={employeeId}\r\n                    job={\"no\"}\r\n                // lmia={lmiaStatus}\r\n                />\r\n            ) : null}\r\n            <div className=\"bg-white shadow-8 datatable_div  pt-7 rounded pb-8 px-2 \">\r\n                <div className=\"table-responsive main_table_div\">\r\n                    {isLoading ? (\r\n                        <Loader />\r\n                    ) : (\r\n                        <table className=\"table table-striped main_data_table\">\r\n                            <thead>\r\n                                <tr className=\"\">\r\n                                    <th\r\n                                        scope=\"col\"\r\n                                        className=\" border-0 font-size-4 font-weight-normal\"\r\n                                    >\r\n                                        EID\r\n                                    </th>\r\n                                    <th\r\n                                        scope=\"col\"\r\n                                        className=\" border-0 font-size-4 font-weight-normal\"\r\n                                    >\r\n                                        <Link\r\n                                            to={\"\"}\r\n                                            onClick={() => {\r\n                                                handleSort(\"name\");\r\n                                                setCurrentPage(1);\r\n                                            }}\r\n                                            className=\"text-gray\"\r\n                                            title=\"Sort by Name\"\r\n                                        >\r\n                                            Name\r\n                                        </Link>\r\n                                    </th>\r\n                                    <th\r\n                                        scope=\"col\"\r\n                                        className=\"border-0 font-size-4 font-weight-normal\"\r\n                                    >\r\n                                        <Link\r\n                                            to={\"\"}\r\n                                            onClick={() => {\r\n                                                handleSort(\"contact_no\");\r\n                                                setCurrentPage(1);\r\n                                            }}\r\n                                            className=\"text-gray\"\r\n                                            title=\"Sort by Contact\"\r\n                                        >\r\n                                            Contact\r\n                                        </Link>\r\n                                    </th>\r\n                                    {props.heading === \"Dashboard\" ? (\r\n                                        \"\"\r\n                                    ) : (\r\n                                        <th\r\n                                            scope=\"col\"\r\n                                            className=\"border-0 font-size-4 font-weight-normal\"\r\n                                        >\r\n                                            <Link\r\n                                                to={\"\"}\r\n                                                onClick={() => {\r\n                                                    handleSort(\"language\");\r\n                                                    setCurrentPage(1);\r\n                                                }}\r\n                                                className=\"text-gray\"\r\n                                                title=\"Sort by Languages\"\r\n                                            >\r\n                                                Languages\r\n                                            </Link>\r\n                                        </th>\r\n                                    )}\r\n                                    {props.heading === \"Dashboard\" ? (\r\n                                        \"\"\r\n                                    ) : (\r\n                                        <th\r\n                                            scope=\"col\"\r\n                                            className=\"border-0 font-size-4 font-weight-normal\"\r\n                                        >\r\n                                            <Link\r\n                                                to={\"\"}\r\n                                                onClick={() => {\r\n                                                    handleSort(\"interested_in\");\r\n                                                    setCurrentPage(1);\r\n                                                }}\r\n                                                className=\"text-gray\"\r\n                                                title=\"Sort by interested in\"\r\n                                            >\r\n                                                Interested in\r\n                                            </Link>\r\n                                        </th>\r\n                                    )}\r\n                                    {props.heading === \"Dashboard\" ? (\r\n                                        \"\"\r\n                                    ) : (\r\n                                        <th\r\n                                            scope=\"col\"\r\n                                            className=\"border-0 font-size-4 font-weight-normal\"\r\n                                        >\r\n                                            <Link\r\n                                                to={\"\"}\r\n                                                onClick={() => {\r\n                                                    handleSort(\"visa_country\");\r\n                                                    setCurrentPage(1);\r\n                                                }}\r\n                                                className=\"text-gray\"\r\n                                                title=\"Sort by visa country\"\r\n                                            >\r\n                                                Visa country\r\n                                            </Link>\r\n                                        </th>\r\n                                    )}\r\n                                    {props.heading === \"Dashboard\" ? (\r\n                                        \"\"\r\n                                    ) : (\r\n                                        <th\r\n                                            scope=\"col\"\r\n                                            className=\"border-0 font-size-4 font-weight-normal\"\r\n                                        >\r\n                                            <Link\r\n                                                to={\"\"}\r\n                                                onClick={() => {\r\n                                                    handleSort(\"experience\");\r\n                                                    setCurrentPage(1);\r\n                                                }}\r\n                                                className=\"text-gray\"\r\n                                                title=\"Sort by Experience\"\r\n                                            >\r\n                                                Experience\r\n                                            </Link>\r\n                                        </th>\r\n                                    )}\r\n                                    <th\r\n                                        scope=\"col\"\r\n                                        className=\"border-0 font-size-4 font-weight-normal\"\r\n                                    >\r\n                                        Profile\r\n                                    </th>\r\n                                    {props.visa === \"yes\" ? null : (\r\n                                        <th\r\n                                            scope=\"col\"\r\n                                            className=\"border-0 font-size-4 font-weight-normal\"\r\n                                        >\r\n                                            Status\r\n                                        </th>\r\n                                    )}\r\n                                    {props.heading === \"Dashboard\" ? (\r\n                                        \"\"\r\n                                    ) : (\r\n                                        <th\r\n                                            scope=\"col\"\r\n                                            className=\"border-0 font-size-4 font-weight-normal\"\r\n                                        >\r\n                                            Action\r\n                                        </th>\r\n                                    )}\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {/* Map function to show the data in the list*/}\r\n                                {totalData === 0 || employeeData.length === 0 ? (\r\n                                    <tr>\r\n                                        <th className=\"bg-white\"></th>\r\n                                        <th className=\"bg-white\"></th>\r\n                                        {props.heading === \"Dashboard\" ? (\r\n                                            <th className=\"bg-white text-center\">No Data Found</th>\r\n                                        ) : (\r\n                                            <th className=\"bg-white\"></th>\r\n                                        )}\r\n                                        <th className=\"bg-white\"></th>\r\n                                        {props.heading === \"Dashboard\" ? null : (\r\n                                            <th className=\"bg-white text-center\">No Data Found</th>\r\n                                        )}\r\n                                        <th className=\"bg-white\"></th>\r\n                                        {props.heading !== \"Dashboard\" ? (\r\n                                            <>\r\n                                                <th className=\"bg-white\"></th>\r\n                                                <th className=\"bg-white\"></th>\r\n                                                <th className=\"bg-white\"></th>\r\n                                                <th className=\"bg-white\"></th>\r\n                                            </>\r\n                                        ) : (\r\n                                            \"\"\r\n                                        )}\r\n                                    </tr>\r\n                                ) : (\r\n                                    (employeeData || []).map((empdata) => (\r\n                                        <tr className=\"applicant_row\" key={empdata.employee_id}>\r\n                                            <td className=\" py-5\">\r\n                                                <p className=\"font-size-3 font-weight-normal text-black-2 mb-0\">\r\n                                                    <Link\r\n                                                        className=\"text-dark\" to={`/${empdata.employee_id}`}>\r\n                                                        {empdata.employee_id}\r\n                                                    </Link>\r\n                                                </p>\r\n                                            </td>\r\n                                            <td className=\" py-5\">\r\n                                                <div className=\"d-flex profile_box gx-2\">\r\n                                                    <div className=\"media  align-items-center\">\r\n                                                        <div className=\"circle-36 mx-auto overflow-hidden\">\r\n                                                            {empdata.profile_photo === null ? (\r\n                                                                <img\r\n                                                                    src=\"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460__340.png\"\r\n                                                                    alt=\"\"\r\n                                                                    className=\"w-100\"\r\n                                                                />\r\n                                                            ) : (\r\n                                                                <img\r\n                                                                    src={empdata.profile_photo}\r\n                                                                    alt=\"\"\r\n                                                                    className=\"w-100\"\r\n                                                                />\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    <div\r\n                                                        title=\"Employee Details\"\r\n                                                    >\r\n                                                        {empdata.name === null ? (\r\n                                                            <div className=\"font-size-3 mb-0 text-capitalize\">\r\n                                                                Unavailable\r\n                                                            </div>\r\n                                                        ) : (\r\n                                                            <div className=\" mb-0\">\r\n                                                                <p className=\"m-0 text-black-2 font-weight-bold text-capitalize\">\r\n\r\n                                                                    <Link\r\n                                                                        className=\"text-dark\"\r\n                                                                        to={`/${empdata.employee_id}`}>\r\n                                                                        {empdata.name}\r\n                                                                    </Link>\r\n                                                                </p>\r\n                                                                <p className=\"text-gray font-size-2 m-0 text-capitalize\">\r\n                                                                    {empdata.gender === \"female\" ? \"F\" : empdata.gender === \"male\" ? \"M\" : \"O\"} (\r\n                                                                    {empdata.marital_status + \", \"}\r\n                                                                    {/*Calculation of age from date of birth*/}\r\n                                                                    {moment().diff(\r\n                                                                        empdata.date_of_birth,\r\n                                                                        \"years\"\r\n                                                                    )}\r\n                                                                    Y)\r\n                                                                    {empdata.is_featured === \"1\" ? (\r\n                                                                        <span className=\"bg-orange text-white featured_tag\">\r\n\r\n                                                                            Featured\r\n                                                                        </span>\r\n                                                                    ) : null}\r\n                                                                    {empdata.created_by_admin === \"0\" ? (\r\n                                                                        <span className=\"bg-info text-white web_tag\">\r\n                                                                            Web\r\n                                                                        </span>\r\n                                                                    ) : null}\r\n                                                                </p>\r\n                                                            </div>\r\n                                                        )}\r\n                                                    </div>\r\n\r\n                                                </div>\r\n                                            </td>\r\n                                            <td className=\"py-5 \">\r\n                                                {empdata.contact_no === null ? (\r\n                                                    <p className=\"font-size-3 mb-0\">Unavailable</p>\r\n                                                ) : (\r\n                                                    <p className=\"m-0\">\r\n                                                        +\r\n                                                        <Link\r\n                                                            className=\"text-dark\"\r\n                                                            to={`tel:${empdata.contact_no}`}\r\n                                                        >\r\n                                                            {empdata.contact_no}\r\n                                                        </Link>\r\n                                                    </p>\r\n                                                )}\r\n                                                <h3 className=\"font-size-3 font-weight-normal text-black-2 mb-0\">\r\n                                                    <p className=\"text-gray font-size-2 m-0\">\r\n                                                        <Link\r\n                                                            className=\"text-dark\"\r\n                                                            to={`mailto:${empdata.email}`}\r\n                                                        >\r\n                                                            {empdata.email}\r\n                                                        </Link>\r\n                                                    </p>\r\n                                                </h3>\r\n                                            </td>\r\n\r\n                                            {props.heading === \"Dashboard\" ? (\r\n                                                \"\"\r\n                                            ) : (\r\n                                                <td className=\" py-5\">\r\n                                                    {empdata.language === null ? (\r\n                                                        <p className=\"font-size-3  mb-0\">Unavailable</p>\r\n                                                    ) : (\r\n                                                        <p className=\"font-size-3 font-weight-normal text-black-2 mb-0\">\r\n                                                            {empdata.language}\r\n                                                        </p>\r\n                                                    )}\r\n                                                </td>\r\n                                            )}\r\n                                            {props.heading === \"Dashboard\" ? (\r\n                                                \"\"\r\n                                            ) : (\r\n                                                <td className=\" py-5\">\r\n                                                    {empdata.interested_in === null ? (\r\n                                                        <p className=\"font-size-3  mb-0\">Unavailable</p>\r\n                                                    ) : (\r\n                                                        <p className=\"font-size-3 font-weight-normal text-black-2 mb-0 text-truncate\">\r\n                                                            {empdata.interested_in}\r\n                                                        </p>\r\n                                                    )}\r\n                                                </td>\r\n                                            )}\r\n                                            {props.heading === \"Dashboard\" ? (\r\n                                                \"\"\r\n                                            ) : (\r\n                                                <td className=\" py-5\">\r\n                                                    {empdata.visa_country === null || empdata.visa_country === \"\" ? (\r\n                                                        <p className=\"font-size-3  mb-0\">Unavailable</p>\r\n                                                    ) : (\r\n                                                        <p className=\"font-size-3 font-weight-normal text-black-2 mb-0 text-truncate\">\r\n                                                            {empdata.visa_country}\r\n                                                        </p>\r\n                                                    )}\r\n                                                </td>\r\n                                            )}\r\n                                            {props.heading === \"Dashboard\" ? (\r\n                                                \"\"\r\n                                            ) : (\r\n                                                <td className=\" py-5\">\r\n                                                    {empdata.experience === null ? (\r\n                                                        <p className=\"font-size-3 mb-0\">Unavailable</p>\r\n                                                    ) : (\r\n                                                        <p className=\"font-size-3 font-weight-normal text-black-2 mb-0\">\r\n                                                            {empdata.experience} Years\r\n                                                        </p>\r\n                                                    )}\r\n                                                </td>\r\n                                            )}\r\n                                            <td className=\" py-5\">\r\n                                                <p className=\"font-size-2 font-weight-normal text-black-2 mb-0\">\r\n                                                    {empdata.profile_complete === \"100.00\" ? (\r\n                                                        <span className=\"p-1 bg-primary-opacity-8 text-white text-center w-100 border rounded-pill\">\r\n                                                            Complete\r\n                                                        </span>\r\n                                                    ) : (\r\n                                                        <span className=\"p-1 bg-warning text-white text-center w-100 border rounded-pill\">\r\n                                                            Incompelete\r\n                                                        </span>\r\n                                                    )}\r\n                                                </p>\r\n                                            </td>\r\n\r\n                                            <td className=\"\">\r\n                                                <p className=\"font-size-2 font-weight-normal text-black-2 mb-0\">\r\n                                                    {empdata.visa_status === \"onboard\" ? (\r\n                                                        <span className=\"p-1 bg-coral-opacity-visible text-white text-center w-100 border rounded-pill\">\r\n                                                            On Board\r\n                                                        </span>\r\n                                                    ) : empdata.visa_status === \"documentation\" ? (\r\n                                                        <span className=\"p-1 bg-warning text-white text-center w-100 border rounded-pill\">\r\n                                                            Documentation\r\n                                                        </span>\r\n                                                    ) : empdata.visa_status === \"file preparation\" ? (\r\n                                                        <span className=\"p-1 bg-info text-white text-center w-100 border rounded-pill\">\r\n                                                            File Preparation\r\n                                                        </span>\r\n                                                    ) : empdata.visa_status === \"file review\" ? (\r\n                                                        <span className=\"p-1 bg-primary-opacity-8 text-white text-center w-100 border rounded-pill\">\r\n                                                            File Review\r\n                                                        </span>\r\n                                                    ) : empdata.visa_status === \"file submission\" ? (\r\n                                                        <span className=\"p-1 bg-dark text-white text-center w-100 border rounded-pill\">\r\n                                                            File Submission\r\n                                                        </span>\r\n                                                    ) : empdata.visa_status === \"file decision\" ? (\r\n                                                        <span className=\"p-1 bg-gray text-white text-center w-100 border rounded-pill\">\r\n                                                            File Decision\r\n                                                        </span>\r\n                                                    ) : (\r\n                                                        <span className=\"font-size-3 font-weight-normal text-black-2 mb-0\">\r\n                                                            NA\r\n                                                        </span>\r\n                                                    )}\r\n                                                </p>\r\n                                            </td>\r\n\r\n                                            {/* Calulation to get user is new or retained */}\r\n                                            {/* <td className=\" py-5\">\r\n                        <p className=\"font-size-3 font-weight-normal text-black-2 mb-0\">\r\n                          {(new Date(empdata.created_at) >= oneMonthAgo && new Date(empdata.created_at) <= currentDate) === true ? \"New\" : \"Retained\"}                        \r\n                          </p>\r\n                      </td> */}\r\n\r\n                                            <td className=\" py-5 min-width-px-100\">\r\n                                                <div\r\n                                                    className=\"btn-group button_group\"\r\n                                                    role=\"group\"\r\n                                                    aria-label=\"Basic example\"\r\n                                                >\r\n                                                    <button\r\n                                                        className=\"btn btn-outline-info action_btn\"\r\n                                                        onClick={() => editVisa(empdata)}\r\n                                                        title=\"Update Visa status\"\r\n                                                    >\r\n                                                        <span className=\"text-gray px-2\"><LiaCcVisa /></span>\r\n                                                        {/* <span className=\"fab fa-cc-visa text-gray px-2\"></span> */}\r\n                                                    </button>\r\n\r\n                                                    <button\r\n                                                        className={props.page === \"user_profile\" ? \"d-none\" : \"btn btn-outline-info action_btn\"}\r\n                                                        onClick={() =>\r\n                                                            AddDoucument(empdata)\r\n                                                        }\r\n                                                        title=\"Documents\"\r\n                                                    >\r\n\r\n                                                        <span className=\"text-gray\"><GrDocumentUser /></span>\r\n                                                        {/* <span className=\"fas fa-file text-gray\"></span> */}\r\n                                                    </button>\r\n                                                </div>\r\n                                            </td>\r\n\r\n                                        </tr>\r\n                                    ))\r\n                                )}\r\n                            </tbody>\r\n                        </table>\r\n                    )}\r\n                </div>\r\n                <div className=\"pt-2\">\r\n\r\n                    <Pagination\r\n                        nPages={nPages}\r\n                        currentPage={currentPage}\r\n                        setCurrentPage={setCurrentPage}\r\n                        total={totalData}\r\n                        count={employeeData.length}\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n        </>\r\n    );\r\n}\r\n"
        }
    ]
}