{
    "sourceFile": "src/components/common/Adobe/ViewSDKClient.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1713617422044,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1713617422043,
            "name": "Commit-0",
            "content": "import { toast } from \"react-toastify\";\r\nimport { ADocAnnotation, UpdateDocuentcommentAssign } from \"../../../api/api\";\r\n\r\nclass ViewSDKClient {\r\n    constructor() {\r\n        this.readyPromise = new Promise((resolve) => {\r\n            if (window.AdobeDC) {\r\n                resolve();\r\n            } else {\r\n                document.addEventListener(\"adobe_dc_view_sdk.ready\", () => {\r\n                    resolve();\r\n                });\r\n            }\r\n        });\r\n        this.adobeDCView = undefined;\r\n        this.annots = [];\r\n    }\r\n\r\n    ready() {\r\n        return this.readyPromise;\r\n    }\r\n\r\n    previewFile(divId, viewerConfig, url, data, userId, annotationId) {\r\n        const fileExtension = data.name.split('.').pop().toLowerCase();\r\n\r\n        const config = {\r\n            clientId: \"d9b36f468d7a4e4e8b275f13728f1132\",\r\n        };\r\n\r\n        if (divId) {\r\n            config.divId = divId;\r\n        }\r\n\r\n        this.adobeDCView = new window.AdobeDC.View(config);\r\n\r\n        // Set viewer configuration with all options enabled for all file types\r\n        viewerConfig = {\r\n            ...viewerConfig,\r\n            embedMode: window.AdobeDC.View.Enum.EmbedMode.INLINE, // Display inline\r\n            showAnnotationTools: true, // Show annotation tools\r\n            showDownloadPDF: true, // Show download PDF option\r\n            showPrintPDF: true, // Show print PDF option\r\n            enableFormFilling: true, // Enable form filling\r\n            showLeftHandPanel: true, // Show left-hand panel\r\n            showSearchPDF: true, // Show search PDF option\r\n            showDocumentInfo: true, // Show document information\r\n            enablePDFAnnotationEditing: false\r\n        };\r\n\r\n        const previewFilePromise = this.adobeDCView.previewFile({\r\n            content: {\r\n                location: {\r\n                    url: url,\r\n                    fileExtension: fileExtension,\r\n                    fileType: data.mimeType\r\n                },\r\n            },\r\n            metaData: {\r\n                fileName: data.name,\r\n                id: data.id,\r\n                parentReference: data.parentReference,\r\n                userId: userId,\r\n                annotationId: annotationId\r\n            }\r\n        }, viewerConfig);\r\n\r\n        return previewFilePromise;\r\n    }\r\n\r\n    previewFileUsingFilePromise(divId, filePromise, data) {\r\n        this.adobeDCView = new window.AdobeDC.View({\r\n            clientId: \"d9b36f468d7a4e4e8b275f13728f1132\",\r\n            divId,\r\n        });\r\n\r\n        this.adobeDCView.previewFile({\r\n            content: {\r\n                promise: filePromise,\r\n            },\r\n            metaData: {\r\n                fileName: data.name\r\n            }\r\n        }, {});\r\n    }\r\n\r\n    registerSaveApiHandler() {\r\n        const saveApiHandler = (metaData, content, options) => {\r\n            return new Promise(resolve => {\r\n                setTimeout(async () => {\r\n                    const response = {\r\n                        code: window.AdobeDC.View.Enum.ApiResponseCode.SUCCESS,\r\n                        data: {\r\n                            metaData: Object.assign(metaData, { updatedAt: new Date().getTime() }),\r\n                            annotationData: this.annots\r\n                        },\r\n                    };\r\n                    resolve(response);\r\n                    if (this.annots) {\r\n                        if (metaData.annotationId) {\r\n                            let updatedData = {\r\n                                // task_creator_user_id: localStorage.getItem(\"admin_id\"),\r\n                                // task_creator_user_type: \"\",\r\n                                doc_id: metaData.id,\r\n                                // user_admin_assigned: \"\",\r\n                                json: this.annots,\r\n                                // assined_to_user_id: \"\",\r\n                                // assigned_user_type: \"\",\r\n                                // document_url: \"\",\r\n                                // subject_description: \"N/A\",\r\n                                // x_axis: \"0\",\r\n                                // y_axis: \"0\",\r\n                                // type: \"document\",\r\n                                // employee_id: metaData.userId,\r\n                                // doc_parent_id: metaData.parentReference.id,\r\n                                id: metaData.annotationId,\r\n                            }\r\n                            try {\r\n                                let res = await UpdateDocuentcommentAssign(updatedData)\r\n                                if (res.message === \"Task updated successfully!\") {\r\n                                    toast.success(\"Comment Data Updated Successfully\", {\r\n                                        position: toast.POSITION.TOP_RIGHT,\r\n                                        autoClose: 1000,\r\n                                    });\r\n                                }\r\n                            } catch (err) {\r\n                                console.log(err)\r\n                            }\r\n                        } else {\r\n                            try {\r\n                                let res = await ADocAnnotation(\r\n                                    localStorage.getItem(\"admin_id\"),\r\n                                    metaData.id,\r\n                                    \"\",//ASSIGNED ADMIN ID\r\n                                    \"\",//ASSIGNED ADMIN EMAIL\r\n                                    \"\",//SUBJECT\r\n                                    \"N/A\",//COMMENT\r\n                                    \"0\",//X AXIS\r\n                                    \"0\",//Y AXIS\r\n                                    \"document\",\r\n                                    localStorage.getItem(\"admin_type\"), //sender ADMIN type\r\n                                    localStorage.getItem(\"admin\"), //sender name,\r\n                                    \"\", //assigned Admin or user Name,\r\n                                    \"\", //follow up status(for notes only)\r\n                                    \"\", //Next follow up date(for notes only)\r\n                                    \"\", //Assign user type,\r\n                                    \"\", //Document url(for notes only)\r\n                                    localStorage.getItem(\"admin_email\"), //Sender email\r\n                                    metaData.userId, //employee id,\r\n                                    \"\", //assigned_by_id\r\n                                    metaData.parentReference.id, // document parent code,\r\n                                    this.annots,//Annotation data,\r\n                                    metaData.annotationId //annotationId\r\n                                );\r\n                                if (res.data.message === \"task inserted successfully!\") {\r\n                                    toast.success(\"Commented Successfully\", {\r\n                                        position: toast.POSITION.TOP_RIGHT,\r\n                                        autoClose: 1000,\r\n                                    });\r\n                                    //   setSelectedAnnotation(null);\r\n                                    //   setComments(\"\");\r\n                                    //   setCommentApiCall(true);\r\n                                    //   setSelectedAdmin(\"\");\r\n                                    //   setAnnotationMode(!isAnnotationMode);\r\n                                    //   setFilteredEmails([]);\r\n                                    // setNotificationApiCall(true);\r\n                                    localStorage.setItem(\"callNotification\", true);\r\n                                }\r\n                            } catch (err) {\r\n                                console.log(err);\r\n                                if (err.response.data.message === \"required fields cannot be blank\") {\r\n                                    toast.error(\" Please try again later.\", {\r\n                                        position: toast.POSITION.TOP_RIGHT,\r\n                                        autoClose: 1000,\r\n                                    });\r\n                                    //   setSelectedAnnotation(null);\r\n                                    //   setComments(\"\");\r\n                                    //   setSelectedAdmin(\"\");\r\n                                    //   setCommentApiCall(true);\r\n                                    //   setAnnotationMode(!isAnnotationMode);\r\n                                    //   setAddCommentFlag();\r\n                                    //   setFilteredEmails([]);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }, 2000);\r\n            });\r\n        };\r\n        this.adobeDCView.registerCallback(\r\n            window.AdobeDC.View.Enum.CallbackType.SAVE_API,\r\n            saveApiHandler,\r\n            {}\r\n        );\r\n    }\r\n\r\n    registerEventsHandler() {\r\n        this.adobeDCView.registerCallback(\r\n            window.AdobeDC.View.Enum.CallbackType.EVENT_LISTENER,\r\n            event => {\r\n                console.log(event);\r\n            },\r\n            {\r\n                enablePDFAnalytics: true,\r\n            }\r\n        );\r\n    }\r\n}\r\n\r\nexport default ViewSDKClient;\r\n// options: {\r\n//         enableAnnotationAPIs: true, // Enable annotation APIs for the viewer\r\n//         includePDFAnnotations: true, // Include PDF annotations in the preview\r\n//         showPageControls: true, // Show page navigation controls\r\n//         showToolbar: true, // Show the viewer's toolbar\r\n//         showReflowControl: true, // Show reflow control for text reflow\r\n//         openThumbnailsPanel: true, // Open the thumbnails panel by default\r\n//         enableFormNavigation: true, // Enable form navigation controls\r\n//         enableAddTextComment: true, // Enable adding text comments\r\n//         enableAddStickyNote: true, // Enable adding sticky notes\r\n//         showDownloadButton: true, // Show the download button\r\n//         showPrintButton: true, // Show the print button\r\n//         showZoomButtons: true, // Show zoom in/out buttons\r\n//         defaultViewMode: window.AdobeDC.View.Enum.ViewMode.FIT_WIDTH, // Set default view mode\r\n//         showLeftHandPanel: true, // Show the left-hand panel\r\n//         showRightHandPanel: true, // Show the right-hand panel\r\n//         showSearchBar: true, // Show the search bar\r\n//         enableFormFilling: true, // Enable form filling in the viewer\r\n//         enableAutoSave: true, // Enable auto-save feature\r\n//         showDocumentInfo: true, // Show document information\r\n//         enablePDFAnalytics: true, // Enable PDF analytics\r\n//         showAnnotationTools: true, // Show annotation tools\r\n//         showSignaturePanel: true, // Show the signature panel\r\n//         showThumbnailsPanel: true, // Show the thumbnails panel\r\n//         showRotateButton: true, // Show the rotate button\r\n//         showUndoRedoButtons: true, // Show undo/redo buttons\r\n//         showFullScreenButton: true, // Show the full-screen button\r\n//         enableAccessibility: true, // Enable accessibility features\r\n//         showShareButton: true, // Show the share button\r\n//         showOptimizedViewButton: true, // Show the optimized view button\r\n//         showFormResetButton: true, // Show the form reset button\r\n//         showFormSaveButton: true, // Show the form save button\r\n//         enableMultiPageControl: true, // Enable multi-page control\r\n//         enableBookmarkNavigation: true, // Enable bookmark navigation\r\n//         showOpenFileButton: true, // Show the open file button\r\n//         showAddAttachmentButton: true, // Show the add attachment button\r\n//         enableHighlightText: true, // Enable text highlighting\r\n//         enableStrikeoutText: true, // Enable text strikeout\r\n//         enableUnderlineText: true, // Enable text underlining\r\n//         enableAreaHighlight: true, // Enable area highlighting\r\n//         enableLinkAnnotation: true, // Enable link annotations\r\n//         enableTextSelection: true, // Enable text selection\r\n//         enablePanZoom: true, // Enable pan and zoom\r\n//         enableTextAnnotation: true, // Enable text annotation\r\n//         enableRedactText: true, // Enable text redaction\r\n//         enableMeasureTools: true, // Enable measure tools\r\n//         enableCommentingTools: true, // Enable commenting tools\r\n//         enableDigitalSignatureTools: true, // Enable digital signature tools\r\n//         enableHandTool: true, // Enable hand tool for panning\r\n//         enableZoomTools: true, // Enable zoom tools\r\n//         enableRotatePages: true, // Enable page rotation\r\n//         enableScrollZoom: true, // Enable scroll zoom\r\n//         showAnnotationFilters: true, // Show annotation filters\r\n//         enablePageViewTracking: true, // Enable page view tracking\r\n//         enablePerformanceTracking: true, // Enable performance tracking\r\n//         showTutorialButton: true, // Show the tutorial button\r\n//         enableFormsTracking: true, // Enable forms tracking\r\n//         enableTextExtraction: true, // Enable text extraction\r\n//         enableDocumentStructureAnalysis: true, // Enable document structure analysis\r\n//         enablePDFConversion: true, // Enable PDF conversion\r\n//         enablePDFSigning: true, // Enable PDF signing\r\n//         enablePDFEditing: true, // Enable PDF editing\r\n//         enablePDFCreation: true, // Enable PDF creation\r\n//         enablePDFAnnotationEditing: true, // Enable PDF annotation editing\r\n//         enablePDFRedaction: true, // Enable PDF redaction\r\n//         enablePDFTextEditing: true, // Enable PDF text editing\r\n//         enablePDFImageEditing: true, // Enable PDF image editing\r\n//         enablePDFPageManagement: true, // Enable PDF page management\r\n//         enablePDFPasswordProtection: true, // Enable PDF password protection\r\n//         enablePDFPermissionManagement: true, // Enable PDF permission management\r\n//         enablePDFWatermarking: true, // Enable PDF watermarking\r\n//         enablePDFStamping: true, // Enable PDF stamping\r\n//         enablePDFSearch: true, // Enable PDF search\r\n//         enablePDFCompression: true, // Enable PDF compression\r\n//         enablePDFOptimization: true, // Enable PDF optimization\r\n//         enablePDFAccessibility: true, // Enable PDF accessibility\r\n//         enablePDFPageExtraction: true, // Enable PDF page extraction\r\n//         enablePDFMerge: true, // Enable PDF merge\r\n//         enablePDFSplit: true, // Enable PDF split\r\n//         enablePDFPageRotation: true, // Enable PDF page rotation\r\n//         enablePDFPageInsertion: true, // Enable PDF page insertion\r\n//         enablePDFPageDeletion: true, // Enable PDF page deletion\r\n//         enablePDFPageReordering: true, // Enable PDF page reordering\r\n//         enablePDFPageScaling: true, // Enable PDF page scaling\r\n//         enablePDFPageCropping: true, // Enable PDF page cropping\r\n//         enablePDFTextSearch: true, // Enable PDF text search\r\n//         enablePDFImageSearch: true, // Enable PDF image search\r\n//         enablePDFAnnotationSearch: true, // Enable PDF annotation search\r\n//         enablePDFCommentSearch: true, // Enable PDF comment search\r\n//         enablePDFBookmarkSearch: true, // Enable PDF bookmark search\r\n//         enablePDFContentRedaction: true, // Enable PDF content redaction\r\n//         enablePDFDocumentComparison: true, // Enable PDF document comparison\r\n//         enablePDFTextExtraction: true, // Enable PDF text extraction\r\n//         enablePDFImageExtraction: true, // Enable PDF image extraction\r\n//         enablePDFPageNumbering: true, // Enable PDF page numbering\r\n//         enablePDFExport: true, // Enable PDF export\r\n//         enablePDFImport: true, // Enable PDF import\r\n//         enablePDFSigningWorkflow: true, // Enable PDF signing workflow\r\n//         enablePDFAnnotationWorkflow: true, // Enable PDF annotation workflow\r\n//         enablePDFReviewWorkflow: true, // Enable PDF review workflow\r\n//         enablePDFApprovalWorkflow: true, // Enable PDF approval workflow\r\n//         enablePDFSharingWorkflow: true, // Enable PDF sharing workflow\r\n//         enablePDFPrintingWorkflow: true, // Enable PDF printing workflow\r\n//         enablePDFEncryption: true, // Enable PDF encryption\r\n//         enablePDFDecryption: true, // Enable PDF decryption\r\n//         enablePDFDigitalSignature: true, // Enable PDF digital signature\r\n//         enablePDFCertificateEncryption: true, // Enable PDF certificate encryption\r\n//         enablePDFPasswordEncryption: true, // Enable PDF password encryption\r\n//         enablePDFPublicKeyEncryption: true, // Enable PDF public key encryption\r\n//         enablePDFPrivateKeyEncryption: true, // Enable PDF private key encryption\r\n//         enablePDFPageNumberFormatting: true, // Enable PDF page number formatting\r\n//         enablePDFAnnotationFormatting: true, // Enable PDF annotation formatting\r\n//         enablePDFDocumentFormatting: true, // Enable PDF document formatting\r\n//         enablePDFPageLayout: true, // Enable PDF page layout\r\n//         enablePDFTextFormatting: true, // Enable PDF text formatting\r\n//         enablePDFImageFormatting: true, // Enable PDF image formatting\r\n//         enablePDFAnnotationVisibility: true, // Enable PDF annotation visibility\r\n//         enablePDFAnnotationExport: true, // Enable PDF annotation export\r\n//         enablePDFAnnotationImport: true, // Enable PDF annotation import\r\n//         enablePDFAnnotationCreation: true, // Enable PDF annotation creation\r\n//         enablePDFAnnotationModification: true, // Enable PDF annotation modification\r\n//         enablePDFAnnotationDeletion: true, // Enable PDF annotation deletion\r\n//         enablePDFAnnotationCollaboration: true, // Enable PDF annotation collaboration\r\n//         enablePDFAnnotationReview: true, // Enable PDF annotation review\r\n//         enablePDFAnnotationApproval: true, // Enable PDF annotation approval\r\n//         enablePDFAnnotationSharing: true, // Enable PDF annotation sharing\r\n//         enablePDFAnnotationPrinting: true, // Enable PDF annotation printing\r\n//         enablePDFAnnotationRedaction: true, // Enable PDF annotation redaction\r\n//         enablePDFAnnotationMarkup: true, // Enable PDF annotation markup\r\n//         enablePDFAnnotationCommenting: true, // Enable PDF annotation commenting\r\n//         enablePDFAnnotationStickyNotes: true, // Enable PDF annotation sticky notes\r\n//         enablePDFAnnotationTextHighlighting: true, // Enable PDF annotation text highlighting\r\n//         enablePDFAnnotationTextUnderlining: true, // Enable PDF annotation text underlining\r\n//         enablePDFAnnotationTextStrikethrough: true, // Enable PDF annotation text strikethrough\r\n//         enablePDFAnnotationTextInsertion: true, // Enable PDF annotation text insertion\r\n//         enablePDFAnnotationTextReplacement: true, // Enable PDF annotation text replacement\r\n//         enablePDFAnnotationTextRedaction: true, // Enable PDF annotation text redaction\r\n//         enablePDFAnnotationAreaHighlighting: true, // Enable PDF annotation area highlighting\r\n//         enablePDFAnnotationFreehandDrawing: true, // Enable PDF annotation freehand drawing\r\n//         enablePDFAnnotationLineDrawing: true, // Enable PDF annotation line drawing\r\n//         enablePDFAnnotationArrowDrawing: true, // Enable PDF annotation arrow drawing\r\n//         enablePDFAnnotationRectangleDrawing: true, // Enable PDF annotation rectangle drawing\r\n//         enablePDFAnnotationEllipseDrawing: true, // Enable PDF annotation ellipse drawing\r\n//         enablePDFAnnotationPolygonDrawing: true, // Enable PDF annotation polygon drawing\r\n//         enablePDFAnnotationPolylineDrawing: true, // Enable PDF annotation polyline drawing\r\n//         enablePDFAnnotationMeasurementTools: true, // Enable PDF annotation measurement tools\r\n//         enablePDFAnnotationCalibrationTools: true, // Enable PDF annotation calibration tools\r\n//         enablePDFAnnotationTextCommenting: true, // Enable PDF annotation text commenting\r\n//         enablePDFAnnotationVoiceCommenting: true, // Enable PDF annotation voice commenting\r\n//         enablePDFAnnotationImageStamping: true, // Enable PDF annotation image stamping\r\n//         enablePDFAnnotationSignatureStamping: true, // Enable PDF annotation signature stamping\r\n//         enablePDFAnnotationFileAttachment: true, // Enable PDF annotation file attachment\r\n//         enablePDFAnnotationTextAttachment: true, // Enable PDF annotation text attachment\r\n//         enablePDFAnnotationHyperlink: true, // Enable PDF annotation hyperlink\r\n//         enablePDFAnnotationPopup: true, // Enable PDF annotation popup\r\n//         enablePDFAnnotationRedaction: true, // Enable PDF annotation redaction\r\n//         enablePDFAnnotationRedactionOverlay: true, // Enable PDF annotation redaction overlay\r\n//         enablePDFAnnotationRedactionTextReplacement: true, // Enable PDF annotation redaction text replacement\r\n//         enablePDFAnnotationRedactionTextExtraction: true, // Enable PDF annotation redaction text extraction\r\n//         enablePDFAnnotationRedactionFullTextRedaction: true, // Enable PDF annotation redaction full text redaction\r\n//         enablePDFAnnotationReview: true, // Enable PDF annotation review\r\n//         enablePDFAnnotationReviewStamp: true, // Enable PDF annotation review stamp\r\n//         enablePDFAnnotationReviewHighlight: true, // Enable PDF annotation review highlight\r\n//         enablePDFAnnotationReviewStrikethrough: true, // Enable PDF annotation review strikethrough\r\n//         enablePDFAnnotationReviewUnderline: true, // Enable PDF annotation review underline\r\n//         enablePDFAnnotationReviewTextInsertion: true, // Enable PDF annotation review text insertion\r\n//         enablePDFAnnotationReviewTextReplacement: true, // Enable PDF annotation review text replacement\r\n//         enablePDFAnnotationReviewTextDeletion: true, // Enable PDF annotation review text deletion\r\n//         enablePDFAnnotationReviewTextRedaction: true, // Enable PDF annotation review text redaction\r\n//         enablePDFAnnotationReviewAreaHighlighting: true, // Enable PDF annotation review area highlighting\r\n//         enablePDFAnnotationReviewFreehandDrawing: true, // Enable PDF annotation review freehand drawing\r\n//         enablePDFAnnotationReviewLineDrawing: true, // Enable PDF annotation review line drawing\r\n//         enablePDFAnnotationReviewArrowDrawing: true, // Enable PDF annotation review arrow drawing\r\n//         enablePDFAnnotationReviewRectangleDrawing: true, // Enable PDF annotation review rectangle drawing\r\n//         enablePDFAnnotationReviewEllipseDrawing: true, // Enable PDF annotation review ellipse drawing\r\n//         enablePDFAnnotationReviewPolygonDrawing: true, // Enable PDF annotation review polygon drawing\r\n//         enablePDFAnnotationReviewPolylineDrawing: true, // Enable PDF annotation review polyline drawing\r\n//         enablePDFAnnotationReviewMeasurementTools: true, // Enable PDF annotation review measurement tools\r\n//         enablePDFAnnotationReviewCalibrationTools: true, // Enable PDF annotation review calibration tools\r\n//         enablePDFAnnotationReviewCommenting: true, // Enable PDF annotation review commenting\r\n//         enablePDFAnnotationReviewVoiceCommenting: true, // Enable PDF annotation review voice commenting\r\n//         enablePDFAnnotationReviewImageStamping: true, // Enable PDF annotation review image stamping\r\n//         enablePDFAnnotationReviewSignatureStamping: true, // Enable PDF annotation review signature stamping\r\n//         enablePDFAnnotationReviewFileAttachment: true, // Enable PDF annotation review file attachment\r\n//         enablePDFAnnotationReviewTextAttachment: true, // Enable PDF annotation review text attachment\r\n//         enablePDFAnnotationReviewHyperlink: true, // Enable PDF annotation review hyperlink\r\n//         enablePDFAnnotationReviewPopup: true, // Enable PDF annotation review popup\r\n//         enablePDFAnnotationReviewRedaction: true, // Enable PDF annotation review redaction\r\n//         enablePDFAnnotationReviewRedactionOverlay: true, // Enable PDF annotation review redaction overlay\r\n//         enablePDFAnnotationReviewRedactionTextReplacement: true, // Enable PDF annotation review redaction text replacement\r\n//         enablePDFAnnotationReviewRedactionTextExtraction: true, // Enable PDF annotation review redaction text extraction\r\n//         enablePDFAnnotationReviewRedactionFullTextRedaction: true, // Enable PDF annotation review redaction full text redaction\r\n//         // Add more options as needed based on your requirements\r\n//     },"
        }
    ]
}