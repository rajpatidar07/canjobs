{
    "sourceFile": "src/components/common/partner_page.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1713876386965,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1713876386965,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport Pagination from \"../common/pagination\";\nimport Loader from \"../common/loader\";\nimport { LiaUserEditSolid } from \"react-icons/lia\";\nimport { RiDeleteBin5Line } from \"react-icons/ri\";\nimport { GetAgent, GetAllChartData } from \"../../api/api\";\nimport { MdFormatListBulletedAdd } from \"react-icons/md\";\nimport AgentsEmployee from \"./AgentEmployee\";\nimport ActivityTable from \"./activity_table\";\nimport DataChart from \"./DataChart\";\nexport default function PartnerPage(props) {\n  /*Show modal states */\n  let [apiCall, setApiCall] = useState(false);\n  let [isLoading, setIsLoading] = useState(true);\n  const [AgentId, setAgentId] = useState(\n    props.user === \"agent\" ? localStorage.getItem(\"agent_id\") : \"\"\n  );\n  /*data and id states */\n  const [agenteData, setAgentData] = useState([]);\n  const [chartData, setChartData] = useState([]);\n\n  /*Pagination states */\n  const [totalData, setTotalData] = useState(\"\");\n  const [recordsPerPage] = useState(10);\n  /*Shorting states */\n  const [columnName /*, setcolumnName*/] = useState(\"id\");\n  const [sortOrder /*, setSortOrder*/] = useState(\"\");\n  /* Function to get Employee data*/\n  const AgentData = async () => {\n    // const params = useParams();\n    setIsLoading(true);\n    try {\n      const userData = await GetAgent(\n        props.user === \"agent\" ? AgentId : \"\",\n        props.search,\n        props.pageNo,\n        recordsPerPage,\n        columnName,\n        sortOrder\n      );\n      if (userData.data.data === undefined || userData.data.data.length === 0) {\n        setAgentData([]);\n        setIsLoading(false);\n        setTotalData(0);\n      } else {\n        setAgentData(userData.data.data);\n        setTotalData(userData.data.total_rows);\n        // setAgentId(userData.data.data[0].id);\n        //Condition to get the Employee of Agent id\n        const filteredItems = userData.data.data.filter(\n          (item) => item.agent_employee_count > 0\n        );\n        if (filteredItems.length === 0) {\n          setAgentId();\n        } else {\n          // setAgentId 4: Get the First Item\n          setAgentId(filteredItems[0].id);\n        }\n        setIsLoading(false);\n      }\n    } catch (err) {\n      console.log(err);\n      setIsLoading(false);\n    }\n  };\n\n  /*Function to Get Graph data */\n  const GetChartData = async () => {\n    try {\n      let res = await GetAllChartData(AgentId, \"agent\")\n      if (res.status === 1) {\n        setChartData(res.data)\n      } else {\n        setChartData([])\n      }\n    } catch (err) {\n      console.log(err)\n    }\n  }\n  /*Render function to get the Chart Data*/\n  useEffect(() => {\n    GetChartData()\n// eslint-disable-next-line\n  }, [AgentId])\n\n  /*Render function to get the employer*/\n  useEffect(() => {\n    AgentData();\n    if (props.apiCall === true || apiCall === true) {\n      props.setApiCall(false);\n      setApiCall(false);\n      if (props.user === \"agent\") {\n        setAgentId(localStorage.getItem(\"agent_id\"));\n      } else {\n        setAgentId(\"\");\n      }\n    }\n    // eslint-disable-next-line\n  }, [\n    props.search,\n    props.pageNo,\n    recordsPerPage,\n    columnName,\n    sortOrder,\n    props.apiCall,\n    apiCall,\n  ]);\n    /*Function to open add Document up modal */\n  // const AddDoucument = (e) => {\n  //   setDocumentModal(true);\n  //   setemployeeId(e);\n  // };\n  // /*\n  /*Pagination Calculation */\n  const nPages = Math.ceil(totalData / recordsPerPage);\n\n  /*Sorting Function */\n  // const handleSort = (columnName) => {\n  //   setSortOrder(sortOrder === \"DESC\" ? \"ASC\" : \"DESC\");\n  //   setcolumnName(columnName);\n  // };\n\n  return (\n    <>\n      <div className=\"bg-white rounded p-4\">\n        <div className=\"table-responsive main_table_div\">\n          {isLoading ? (\n            <Loader />\n          ) : (\n            <>\n              {(agenteData || []).map((data, index) => (\n                <div className=\"rounded bg-light p-4 mb-1\" key={index}>\n                  <div\n                    className=\"d-flex align-items-center position-relative\"\n                    key={data.id}\n                  >\n                    {data.profile_image === null ? (\n                      <img\n                        src=\"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460__340.png\"\n                        alt=\"UserName\"\n                        className=\"rounded\"\n                        width=\"90px\"\n                        height=\"90px\"\n                      />\n                    ) : (\n                      <img\n                        src={data.profile_image}\n                        className=\"rounded\"\n                        alt={data.name}\n                        width=\"90px\"\n                        height=\"90px\"\n                      />\n                    )}\n                    <div className=\"ml-5 w-100\">\n                      <Link\n                        // to={`/partner_profile`}\n                        // onClick={localStorage.setItem(\"agent_id\", data.id)\n                        // }\n                        >\n                        <h5 className=\"mb-0 text-capitalize line-height-1 text-break\">\n                          {data.name === null ||\n                            data.name === undefined ||\n                            data.name === \"undefined\" ||\n                            data.name === \"\"\n                            ? \"N/A\"\n                            : data.name}\n                        </h5>\n                      </Link>\n                      <hr className=\"my-3\" />\n                      <div className=\"m-0 age_gender d-flex align-items-center\">\n                        <span className=\"bg-secondary rounded-pill font-size-3 px-3 py-2 text-white mr-2\">\n                          {data.u_id}\n                        </span>\n                        <span className=\"bg-info rounded-pill font-size-3 px-3 py-2 text-white mr-2\">\n                          {data.contact_no}\n                        </span>\n                        <span className=\"bg-warning rounded-pill font-size-3 px-3 py-2 text-white mr-2\">\n                          {data.email}\n                        </span>\n                        <span className=\"bg-primary rounded-pill font-size-3 px-3 py-2 text-white mr-2\">\n                          {` ${data.city},${data.state},${data.country}`}\n                        </span>\n                      </div>\n                    </div>\n                    <div className=\"partner_action_div ml-5 \">\n                      <button\n                        className=\"font-size-3 text-break btn btn-outline-secondary btn-rounded px-4 action_btn m-1\"\n                        onClick={() => {\n                          setAgentId(data.id);\n                        }}\n                        title=\"View Candidate's\"\n                        disabled={data.agent_employee_count === \"0\" || 0}\n                      >\n                        <MdFormatListBulletedAdd /> {\"View Candidate's\"}\n                        {/* <i className=\"fa fa-list\"></i> */}\n                      </button>\n                      <button\n                        className=\"font-size-3 text-break btn btn-outline-secondary btn-rounded px-4 action_btn m-1\"\n                        onClick={() => props.EditAgent(data.id)}\n                        title=\"Edit Partner\"\n                      >\n                        <LiaUserEditSolid /> {\"Edit Partner\"}\n                      </button>\n                      <button\n                        className={\n                          props.user === \"agent\"\n                            ? \"d-none\"\n                            : \"font-size-3 text-break btn btn-outline-secondary btn-rounded px-4 action_btn m-1\"\n                        }\n                        onClick={() => props.ShowDeleteAlert(data)}\n                        title=\"Delete Partner\"\n                      >\n                        <RiDeleteBin5Line /> {\"Delete Partner\"}\n                      </button>\n                    </div>\n                  </div>\n                  {data.id === AgentId &&\n                    data.agent_employee_count !== (0 || \"0\") ? (\n                    <div className=\"row\">\n                      {/* Pie chart */}\n                      <div\n                        id=\"table0\"\n                        className={\"col-md-4\"}\n                      >\n                        <div className=\"bg-white dashboard_card mb-7\">\n                          <div className=\"d-flex justify-content-between p-5 align-items-center\">\n                            <h3 className=\"font-size-5 px-3 m-0 \">Applicant's status</h3>\n                          </div>\n                          <div className=\" mb-7\">\n                            <DataChart data={chartData}\n                              dataType={\"status\"} />\n                          </div>\n                        </div>\n                      </div>\n                      {/* <!-- Agent by emmployee --> */}\n                      <div className=\"col-md-4\">\n                        <AgentsEmployee\n                          Agentid={AgentId}\n                          apiCall={apiCall}\n                          setApiCall={setApiCall}\n                          heading={\"Dashboard\"}\n                          user_of_page={\"agentAssigned\"}\n                        />\n                      </div>\n                      {/* Activity log */}\n                      <div className=\"col-md-4\">\n                        <ActivityTable\n                          user_id={AgentId}\n                          user_type={\"agent\"}\n                          hide={true}\n                        />\n                      </div>\n\n                    </div>\n                  ) : null}\n                </div>\n              ))}\n            </>\n          )}\n        </div>\n        <div className=\"pt-2\">\n          <Pagination\n            nPages={nPages}\n            currentPage={props.pageNo}\n            setCurrentPage={props.setpageNo}\n            total={totalData}\n            count={agenteData.length}\n          />\n        </div>\n      </div>\n      \n    </>\n  );\n}\n"
        }
    ]
}